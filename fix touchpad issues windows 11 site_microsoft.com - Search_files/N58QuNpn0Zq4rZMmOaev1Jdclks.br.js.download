var AutoSuggest,sa_storage,EventKeyCodes,__extends,Bing,sa_inst;(function(n){var t;(function(n){var t,i,r,u,f,e;(function(n){n.User="SRCHHPGUSR"})(t=n.CookieNames||(n.CookieNames={})),function(n){n.AutoSuggest="AS"}(i=n.CrumbNames||(n.CrumbNames={})),function(n){n.CursorPosition="cp";n.ConversationId="cvid";n.SuggestionCount="sc";n.PartialQuery="pq";n.SuggestionPosition="sp";n.SuggestionType="qs";n.PreviewPaneSuggestionType="qsc";n.SkipValue="sk";n.PreviewPaneSkipValue="skc";n.Ghosting="ghc";n.Css="css";n.Count="count";n.DataSet="ds";n.SessionId="sid";n.TimeStamp="qt";n.Query="q";n.ImpressionGuid="ig";n.QFQuery="qry";n.BaseQuery="bq";n.FormCode="form";n.HashedMuid="nclid";n.RequestElToken="elvr";n.ElTokenValue="elv";n.AppId="appid";n.History="history";n.NoHistory="nohs";n.ApiTextDecoration="textdecorations";n.ClientId="clientid";n.Market="mkt";n.Scope="scope";n.CountryCode="cc";n.HomeGeographicRegion="hgr";n.SetLang="setlang";n.ZeroInputSerp="zis";n.GhShown="ghsh";n.GhAccepted="ghacc";n.GhPrefixLength="ghpl";n.LonqQueryParam="lq";n.ASCodeVersion="ascv";n.Csr="csr";n.AsCsrVersion="sm"}(r=n.QueryParams||(n.QueryParams={})),function(n){n.ImpressionGuid="X-MSEdge-IG"}(u=n.Headers||(n.Headers={})),function(n){n.HitHighlighting="h";n.PopularNow="p";n.Local="l";n.Answers="a"}(f=n.Options||(n.Options={})),function(n){n.Id="id";n.Query="query";n.Url="url";n.Navigation="nav";n.Type="stype";n.Autocomplete="hc";n.InstData="h";n.AriaLabel="aria-label";n.RequestGuid="rg";n.AdQuery="adq";n.GhostingText="ghtxt"}(e=n.SuggestionAttributes||(n.SuggestionAttributes={}))})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(n){var t;(function(n){function a(n){return n?n[n[i]!==undefined?i:f]:undefined}function u(n,t){n&&t!==null&&t!==undefined&&(n[n[i]!==undefined?i:f]=t)}function v(n){return _w.getComputedStyle?_w.getComputedStyle(n,null):n.currentStyle}function y(n,t){var r=new RegExp("[?&]{1}"+t+"=([^&]+)"),i=n.match(r);return i?i[1]:null}function p(n,t,i){if(n.setSelectionRange)n.setSelectionRange(t,i);else{var r=n.createTextRange();r.moveEnd("sentence",-1e5);r.moveStart("character",t);r.moveEnd("character",i-t);r.select()}}function w(n,t){for(var r,i,u=0;i=t[u];++u)r=n.getAttribute(i),r&&(n[i]=r)}function b(n){var t=sj_ev(n);return{x:t.clientX,y:t.clientY}}function k(n,t){return function(i){var r=sj_ev(i),u=r.relatedTarget||(r.type=="mouseout"?r.toElement:r.fromElement);t===u||e(u,t)||n.call(t,r)}}function d(n,t){var i=0,r=_d.selection;if(n.selectionStart!=null)i=n.selectionStart;else if(r&&n.createTextRange){t&&n.focus();var u=n.createTextRange(),f=u.duplicate(),e=r.createRange();t&&u.moveToBookmark(e.getBookmark());f.setEndPoint("EndToStart",e);i=f.text.length}return i}function g(n,t){n&&(n.className=n.className.replace(t,""))}function nt(n,t){var u,i,r,f;if(n){for(u=n.className.split(" "),i=0,r=u;i<r.length;i++)if(f=r[i],f===t)return;n.className.length>0&&(n.className+=" ");n.className+=t}}function tt(n,t){return n?n.replace(c,function(n,i){return t[i]}):n}function it(n,t){var i=t.replace(/\s+$/g,"");return t[t.length-1]==" "&&n.length>0&&ot(t,i,n[0])?i:t}function e(n,t){if(!n||!t||t===n)return!1;while(n&&t!==n)n=n.parentElement;return t==n}function rt(n,t,i){var r=h.exec(t);if(!r||!r[1])throw new Error("Given text format doesn't contain link markup");u(i,r[1]);u(n,sa_loc.SearchRemoved);n.innerHTML=n.innerHTML.replace("%e"+i.innerHTML+"%E",et(i))}function ut(n,t,i,r){var u,f;return i===void 0&&(i=null),r===void 0&&(r=!1),u=_d.createElement("span"),u.textContent=t,u.style.visibility="hidden",i&&(u.style.fontSize=i),r&&(u.style.fontWeight="bold"),n.appendChild(u),f=u.offsetWidth,n.removeChild(u),f}function r(n,t,i){try{return n()}catch(r){return i&&i(),t}}function ft(n){return n?"Bearer ".concat(n):""}function et(n){var t=sj_ce("div");return t.appendChild(n),t.innerHTML}function ot(n,t,i){return n==i.substr(0,n.length)||t==i}function t(n){var t=Math.abs(Math.floor(n));return(t<10?"0":"")+t}function st(){var n=new Date,i=-n.getTimezoneOffset(),r=i>=0?"+":"-";return n.getFullYear()+"-"+t(n.getMonth()+1)+"-"+t(n.getDate())+"T"+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"."+t(n.getMilliseconds())+r+t(i/60)+":"+t(i%60)}function ht(t,i,r,u,f,e,s,h){var v,y,b,a,k,d,p,l,c,w,g;return!t||!i||!r?"":(b=encodeURIComponent(i),a={triggeringMode:"Explicit",intent:r},u&&(a.entityId=u),e&&(a.itemId=e),f&&(a.contentSource=f),k=JSON.stringify(a),d=encodeURIComponent(k),s=(v=s!==null&&s!==void 0?s:_G&&_G.IG)!==null&&v!==void 0?v:"",p=(y=_G&&_G.IG)!==null&&y!==void 0?y:"",c=t.bfbSearchUrl,p||(c=c===null||c===void 0?void 0:c.replace("&asig={3}","")),s||(c=c===null||c===void 0?void 0:c.replace("&cvid={4}","")),h&&(c=c===null||c===void 0?void 0:c.concat("&sc="+h+"-"+i.length)),l=n.formatString(c,[b,d,t.bfbfrmcde,p,s]),r==="External"&&f&&(l===null||l===void 0?void 0:l.indexOf("/work"))>-1&&(w=o(f),w&&(g="#Connectors-".concat(w),l=l+g)),l)}function ct(n){var t="/search";return n&&n.substr(0,t.length)===t?"/work"+n:n}function o(n){var t,e=undefined,i;try{if(s()&&(i=_w.sessionStorage.getItem("connectorsVerticalSettings"),i)){var r=JSON.parse(i),u=r===null||r===void 0?void 0:r.data,f=u===null||u===void 0?void 0:u.find(function(t){var i;if((i=t.Entities)!==null&&i!==void 0)return i.some(function(t){var i;if((i=t===null||t===void 0?void 0:t.ContentSources)!==null&&i!==void 0)return i.some(function(t){return(t===null||t===void 0?void 0:t.Id)&&(t===null||t===void 0?void 0:t.Id.toString().toLowerCase())==n.toLowerCase()})})});e=(t=f===null||f===void 0?void 0:f.Id)===null||t===void 0?void 0:t.toLowerCase()}}catch(o){}return e}function lt(n){return r(function(){return _w.localStorage?_w.localStorage.getItem(n):null},null)}function at(n,t,i){var u=new Date,f={value:t,expiry:i?i:u.getTime()+l};return r(function(){_w.localStorage?_w.localStorage.setItem(n,JSON.stringify(f)):null},null)}function vt(n){return r(function(){_w.localStorage?_w.localStorage.removeItem(n):null},null)}function yt(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}function s(){return!!("sessionStorage"in _w&&_w.sessionStorage)}var i="textContent",f="innerText",h=/%e([^%]+)%E/,c=/{([0-9]+)}/g,l=864e5;n.GetTextContent=a;n.SetTextContent=u;n.GetComputedStyle=v;n.GetQueryStringParam=y;n.SetSelectionRange=p;n.RewriteAttribsToProps=w;n.GetMouseCoords=b;n.MouseEnterLeave=k;n.getCursorPosition=d;n.RemoveClassName=g;n.AddClassName=nt;n.formatString=tt;n.TrimmedQueryFromSuggestions=it;n.isChildOf=e;n.SetTextContentWithLink=rt;n.CalcWidth=ut;n.safeExecute=r;n.getBearerTokenHeader=ft;n.getDateWithTimezone=st;n.buildBfbSearchUrl=ht;n.getMSBWorkVerticalSearchUrl=ct;n.getConnectorUrlSuffixFromStorage=o;n.getItem=lt;n.setItem=at;n.removeItem=vt;n.checkIfValidNumber=yt;n.isStorageSupported=s})(t=n.Utils||(n.Utils={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function n(){this._eventRegistry=[]}return n.prototype.registerEvents=function(n){this._eventRegistry.push(n)},n.prototype.raiseEvent=function(n){for(var i,r,f,u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];for(i=0,r=this._eventRegistry;i<r.length;i++)f=r[i],f.raise(n,u)},n.prototype.clearEvents=function(){this._eventRegistry=[]},n}(),t;n.EventRegisterer=i;t=function(){function n(n){this._eventParent=n;this.events=[]}return n.prototype.add=function(n,t){this.events[n]=t},n.prototype.proxy=function(n){for(var i,r,e,u=this,f=[],t=1;t<arguments.length;t++)f[t-1]=arguments[t];for(i=0,r=f;i<r.length;i++)e=r[i],function(t){u.events[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.splice(0,0,t);n.apply(u._eventParent,r)}}(e)},n.prototype.raise=function(n,t){var i=this.events[n];i&&i.apply(this._eventParent,t)},n}();n.EventRegistration=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var r,h,c,s;(function(n){n.Web="Web";n.BingAtWork="BAW";n.Substrate="SSUE";n.MicrosoftSearchInBing="MSB";n.MicrosoftSearchInBingCached="MSBC";n.MSBEngagment="MSBE";n.RichRequery="RR";n.SubstrateSuggestionsForEnterprise="SSUE";n.Sydney="SYC"})(r=t.DataSources||(t.DataSources={})),function(n){n.RelatedSearch="RS";n.PeopleAlsoAsk="PAA";n.PeopleAlsoSearchFor="PASF";n.PeopleAlsoSearchForExploreMore="PASFEM";n.TrendingNowOnRight="TRR"}(h=t.SearchTypeUtils||(t.SearchTypeUtils={})),function(n){n.Bookmarks="Bookmarks";n.People="People"}(c=t.BingAtWorkDataTypes||(t.BingAtWorkDataTypes={}));t.suggestionParentClass="sa_prnt";t.ZisRankableBanners=["BC","TR","SH","SP"];var i=AutoSuggest.Service.QueryParams,e="ajax.unload",l="msb:qf:rdy",u="NONPROM",f="PROM",o=[i.SuggestionPosition,i.Ghosting,i.LonqQueryParam,i.AsCsrVersion],a=o.concat([i.PartialQuery,i.SuggestionCount,i.SuggestionType,i.SkipValue,i.ConversationId,i.GhShown,i.GhAccepted,i.GhPrefixLength,i.LonqQueryParam]);t.searchBoxFocusEventId="SearchBox_Focus";t.msbVerticalClient="BingVertical";s=function(s){function h(n,t,i,r,u,f,e,o,h,c,l,a,v){var y=s.call(this)||this;return y.canvas=n,y._dataProvider=t,y._bingAtWorkDataProvider=i,y._substrateDataProvider=r,y._msbDataProvider=u,y._msbEngagementDataProvider=f,y._instrumentation=e,y._bingAtWorkSuggestionsParser=o,y._substrateSuggestionsParser=h,y._msbSuggestionsParser=c,y._bingAtWorkWebTelemetry=l,y._sydneyDataProviders=a,y.internalEventTrigger=v,y.hasPrefixQueryBeenUpdated=!1,y.currentQuery="",y.data={},y.ghostInstValue=0,y.networkLatencyInfo="",y.ghostingShown=0,y.ghostingAccepted=0,y.ghostingPrefixLength="",y.isLongQuery=!1,y.preactComponentsLoaded=!1,y._cursorPosition=0,y._queryWithCurrentSuggestions="",y._receivedAtLeastOnceValidResponse=!1,y._isDisposed=!1,y._requestSequence=-1,y._isBawPayloadAdded=!1,y._originalQuery="",y._previousLocationCache=null,y._emptyWebSuggestionsResponse="<span><\/span>",y.msbNtpKeyStrokeMaxRetry=0,y._cacheZisEarly=!1,y.isMsbCachingBundleReady=!1,y}return __extends(h,s),h.prototype.init=function(n,i,r){var u=this,s,c,l,a,v,e,y,w,b,f,k,d,g,nt,o,p;for(this._originalQuery=r.value,this.config=n,this._container=i,this.registerAjaxSerpUnloadEvent(),this.previousQuery=r===null||r===void 0?void 0:r.value,e=0,y=h.ScopeExtensions;e<y.length;e++)w=y[e],w.init(this);h.ScopeExtensions=[];b=function(t,i,r,f,e,o,s){return u.dataProviderCallbackFunc(t,i,r,f,e,n.msbClient,s)};this._dataProvider.init(n,n.u,b);this.canvas.init(this,n,i,r);f=new t.EventRegistration(this);f.proxy(this.raiseEvent,10,12,11);this._bingAtWorkDataProvider&&(k=function(n,t,i,r,f,e){return u.onBingAtWorkResponseReceived(n,t,i,e)},this._bingAtWorkDataProvider.init(n,this.config.bingAtWorkUrl,k));this._substrateDataProvider&&(d=function(n,t,i){return u.onSubstrateResponseReceived(n,t,i)},this._substrateDataProvider.init(n,"",d));this._msbDataProvider&&(o=function(t,i,r,f,e,o,s){return u.onSearchBoxFocusWithRetry(1,r,function(){return u.onMsbResponseReceived(t,i,r,f,e,o,s,n.msbClient)})},g=function(n,t,i,r,f,e,o){return u.onMsbResponseReceived(n,t,i,r,f,e,o)},this._msbDataProvider.init(o,this._bingAtWorkWebTelemetry,g));this._sydneyDataProviders&&(nt=function(n,t,i){return u.onSydneyReponse(n,t,i)},this._sydneyDataProviders.init(nt));this._msbEngagementDataProvider&&(o=function(n,t){return u.onSearchBoxFocusWithRetry(1,t,function(){return u.onMsbEngagementResponseReceived(n,t)})},this._msbEngagementDataProvider.init(o));f.add(4,function(n,t,i){u.raiseEvent(4,n,t,i)});f.add(20,function(n,t){t.className.indexOf("as_qb")!=-1&&(u.raiseEvent(13,n.query+" ",!1),_w.Log&&Log.Log&&Log.Log("Select","QueryBuilder","Click",!1,"ImpressionGuid",u.data.Inst.IG))});f.add(25,function(n){u.raiseEvent(13,n.query+" ",!1);_w.Log&&Log.Log&&Log.Log("Select","MobileNextWordSuggestion","Click",!1,"ImpressionGuid",u.data.Inst.IG)});this.canvas.registerEvents(f);this.raiseEvent(6,this);n.isEdgeNtp&&this.isMsbEnabled(n.enabledDataSources)&&(this.msbNtpKeyStrokeMaxRetry=n.msbKsTnsTryMax||0,this.raiseEvent(21));(n.msbqc||this.config.isNtpClientqfEnabled)&&this.initMsbQfCaching();this.internalEventTrigger&&(p=new t.EventRegistration(this),p.add(33,function(n){u.raiseEvent(13,n+" ",!1);_w.Log&&Log.Log&&Log.Log("Select","QueryBuilder","Click",!1,"ImpressionGuid",u.data.Inst.IG)}),this.internalEventTrigger.registerEvents(p));performance&&performance.getEntries&&this.LogPerformanceTiming(["AutosuggestBootstrapLoaded","AutosuggestJSBundleLoaded"]);((c=(s=window.BingAtWork)===null||s===void 0?void 0:s.context)===null||c===void 0?void 0:c.isSharedSerpWorkBundlesEnabled)&&((a=(l=window.BingAtWork)===null||l===void 0?void 0:l.context)===null||a===void 0?void 0:a.isOnWorkVertical)&&((v=window.BingAtWork)===null||v===void 0?void 0:v.initAutoSuggest())},h.prototype.initMsbQfCaching=function(){for(var i=this,t=!1,n=0;n<this.config.enabledDataSources.length;++n)if(this.config.enabledDataSources[n]===r.MicrosoftSearchInBing){this.config.enabledDataSources.splice(n,null,r.MicrosoftSearchInBingCached);t=!0;break}t||this.config.enabledDataSources.push(r.MicrosoftSearchInBingCached);sj_evt.bind(l,function(){return i.isMsbCachingBundleReady=!0},!0)},h.prototype.isMsbEnabled=function(n){var i,t,u,f;if(!n)return!1;for(i=!1,t=0,u=n;t<u.length;t++)if(f=u[t],f===r.BingAtWork||f===r.MicrosoftSearchInBing){i=!0;break}return i},h.prototype.raiseGhostingEventFired=function(n,t){this.raiseEvent(31,n,t)},h.prototype.raiseGhostedTextLength=function(n,t){this.raiseEvent(26,n,t)},h.prototype.raiseGhostingAccepted=function(n,t,i){this.raiseEvent(27,n,t,i)},h.prototype.raiseUpdateGhostedText=function(n,t,i,r){this.raiseEvent(14,n,t,i,r)},h.prototype.raiseUpdateTextAndRequery=function(n,t){this.raiseEvent(13,n,t)},h.prototype.raiseUpdateText=function(n,t){t===void 0&&(t=!0);this.raiseEvent(12,n,t)},h.prototype.raiseTextChanged=function(n,t){this.raiseEvent(18,n,t)},h.prototype.onBfbNavigateCallback=function(n,t,i,r,e,o){if(this._bingAtWorkWebTelemetry){var s={LogicalId:_G.LogicalId?_G.LogicalId:"",N:r?r.length:0,QTYP:t,TT:i?f:u,eventId:"QueryFormulation_Click"};this._bingAtWorkWebTelemetry.logClicked(n,s);this._bingAtWorkWebTelemetry.log3SClickedEvent("QueryFormulation_Click",e,t,o,n)}},h.prototype.onHighConfidencePromoted=function(n){if(this._bingAtWorkWebTelemetry&&this.config.enableQfHcLog){var t=this._bingAtWorkWebTelemetry.getLogicalId(),i={LogicalId:t,N:this.currentQuery.length,TT:n?f:u,eventId:"QueryFormulation_HighConfidence_Impression"};this._bingAtWorkWebTelemetry.logShown("",i)}},h.prototype.onBfbSearchBoxAction=function(n){this._bingAtWorkWebTelemetry&&(n===t.searchBoxFocusEventId&&this._bingAtWorkWebTelemetry.createAndUpdateConversationId&&this._bingAtWorkWebTelemetry.createAndUpdateConversationId(),this._bingAtWorkWebTelemetry.log3SClickedEvent&&this._bingAtWorkWebTelemetry.log3SClickedEvent(n))},h.prototype.onSubstrateNavigateCallback=function(n){this._substrateDataProvider&&this._substrateDataProvider.instrumentClick(n)},h.prototype.setData=function(n){this.data=n},h.prototype.dataProviderCallbackFunc=function(i,u,f,e,o,s,h){var y,p,l,a,w,b,v,c,k;(this._previousLocationCache=o||this._previousLocationCache,!this._isDisposed&&(this.canvas.searchBoxHasFocus()||this.config.mnw))&&(this._cacheZisEarly||(t.CachedResponseUtils&&t.CachedResponseUtils.checkCachedResponseAndLog&&(i=t.CachedResponseUtils.checkCachedResponseAndLog(i,e)),s!==t.msbVerticalClient&&this.raiseEvent(8),i!=null&&(this.raiseEvent(9,f,u,r.Web,h),this._queryWithCurrentSuggestions=f,this.config.ascsr?sj_evt.fire("AS.ResponseRecieved",i,this.currentQuery,u,f!=this.currentQuery):this.canvas.render(i,this.currentQuery,u,r.Web,f!=this.currentQuery),this._receivedAtLeastOnceValidResponse=!0,this.config.enbleClientPerfTelemetry&&this._instrumentation&&this._instrumentation.logASNetworkCallLatency&&typeof performance!="undefined"&&performance&&performance.getEntries&&(y=this._instrumentation.logASNetworkCallLatency(),y!==""&&this.appendLatency(y)),p=_ge("sa_msbblockheader"),l=_ge("sa_msbblockheaderwithtenantname"),l&&p&&(a=p,w=n.AS.BingAtWorkTemplateManager.getTenantDisplayName(),w&&(b=l.innerHTML.replace("{0}",w),b.length<=70&&(a=l,a.innerHTML=b)),a.style.display="block",v=_ge("as_msbblkhdrnew"),c=n.AS.BingAtWorkTemplateManager.getTenantThemeColors(),c&&c.length>2&&(v===null||v===void 0?void 0:v.setAttribute("style","background-color : #"+c[1]+"; color : #"+c[2]+";"))),this._instrumentation&&(k=this.data&&this.data.Inst?this.data.Inst.IG:null,this._instrumentation.updateImpressionGuid(k,u)))))},h.prototype.onSubstrateResponseReceived=function(n,i,u){var f=this,e,o;!this._isDisposed&&this.canvas.searchBoxHasFocus()&&u==this.currentQuery&&(this.config.handleDuplicateFetch&&i<this._requestSequence||(e=sb_gt(),o=function(n,o){var s=t.BingAtWorkTemplateManager.generateHtml(f.config,n,u);n.length&&(f._instrumentation.instrumentResponseReceived(r.Substrate,i,e),f._bingAtWorkWebTelemetry&&f._bingAtWorkWebTelemetry.logPerf("SSUESuggestions"));f._instrumentation.instrumentDataSource(r.Substrate,n,i,o);f.config.msbSusR&&(f._substrateDataProvider.updateTraceId(o.TraceID),f.canvas.render(s,f.currentQuery,i,r.Substrate),s&&(f._instrumentation.updateRendered(i),f._bingAtWorkWebTelemetry&&(f._bingAtWorkWebTelemetry.setContext({traceId:o.TraceID,tenantId:f.config.bawTenantId,uid:f.config.bawUserId}),n.forEach(function(n){f._bingAtWorkWebTelemetry.logShown(n.id)}))))},this._substrateSuggestionsParser.parse(u,n,i,o)))},h.prototype.onMsbEngagementResponseReceived=function(n,i){if(!this._isDisposed&&this.canvas.searchBoxHasFocus()&&i==this.currentQuery&&(!this.config.handleDuplicateFetch||!(n<this._requestSequence))){var u=t.BingAtWorkTemplateManager.generateMSBEngagementHtml(this.config,i,this.config.msbengagementformcode);u&&this.canvas.render(u,this.currentQuery,n,r.MSBEngagment)}},h.prototype.onSydneyReponse=function(n,t,i){this.canvas.render(n,t,i,r.Sydney)},h.prototype.onMsbResponseReceived=function(n,i,e,o,s,h,c,l){var a=this,y;if((l===t.msbVerticalClient&&o&&this.raiseEvent(8),!this._isDisposed&&this.canvas.searchBoxHasFocus()&&e==this.currentQuery)&&(!this.config.handleDuplicateFetch||!(i<this._requestSequence))){var p=sb_gt(),v=o?r.MicrosoftSearchInBingCached:r.MicrosoftSearchInBing,w=function(n,r,h){var l,k,w,y,b,d,g;if(n&&n.length&&a._instrumentation.instrumentResponseReceived(v,i,p),a._instrumentation.instrumentDataSource(v,n,i,r,c),!(a.config.ascsr&&a.config.enableCSRForBAW)&&(l=void 0,l=a.config.promoteUserHistoryForAADUser&&v==="MSBC"?t.BingAtWorkTemplateManager.generateMsbHtml(a.config,n,e,a.config.isMsbInline,h===null||h===void 0?void 0:h.LogicalId):a.config.webMsbQFRanking&&v==="MSBC"?t.BingAtWorkTemplateManager.generateMsbHtml(a.config,n,e,a.config.isMsbInline,h===null||h===void 0?void 0:h.LogicalId):t.BingAtWorkTemplateManager.generateHtml(a.config,n,e,a.config.isMsbInline),a.canvas.render(l,a.currentQuery,i,v),l&&(a.config.isEdgeNtp||(a.config.zisHistoryAfterPn&&n!==undefined&&(n===null||n===void 0?void 0:n.length)>=0&&a.raiseEvent(34,e,n.length,i),a._instrumentation.updateRendered(i)),a._bingAtWorkWebTelemetry))){if(a._bingAtWorkWebTelemetry.setContext({traceId:r?r.TraceID:"",tenantId:a.config.bawTenantId,uid:a.config.bawUserId}),s=s||a._bingAtWorkWebTelemetry.getLogicalId(),k=JSON.stringify(n.map(function(n){return n.stype})),w={LogicalId:s,N:a.currentQuery.length,QTYP:k,TT:u,QTYPE:a.currentQuery.length==0?"zqf":o?"cache":"backfill"},a.config.isLowConfidenceWeb)for(y=0,b=n;y<b.length;y++)if(d=b[y],d.confidence=="High"){w.TT=f;break}g=JSON.stringify(n.map(function(n){return n.id}));a._bingAtWorkWebTelemetry.logShown(g,w);a._bingAtWorkWebTelemetry.log3sRenderedEvent(h,n)}};(y=this._msbSuggestionsParser)===null||y===void 0?void 0:y.parse(n,i,w,h,this.currentQuery,e!=this.currentQuery)}},h.prototype.onBingAtWorkResponseReceived=function(n,i,u,f){var e=this,o,s;!this._isDisposed&&this.canvas.searchBoxHasFocus()&&u==this.currentQuery&&(this.config.handleDuplicateFetch&&i<this._requestSequence||(o=sb_gt(),this.config.isEdgeNtp&&(this.raiseEvent(8),f==401&&this.msbNtpKeyStrokeMaxRetry>0&&(this.msbNtpKeyStrokeMaxRetry--,this.raiseEvent(21))),s=function(n,f){var s=t.BingAtWorkTemplateManager.generateHtml(e.config,n,u,e.config.isMsbInline);n.length&&(e.config.isEdgeNtp?e.raiseEvent(9,u,i,r.BingAtWork):(e._instrumentation&&e._instrumentation.instrumentResponseReceived(r.BingAtWork,i,o),e._bingAtWorkWebTelemetry&&e._bingAtWorkWebTelemetry.logPerf("BAWSuggestions")));e._instrumentation&&e._instrumentation.instrumentDataSource(r.BingAtWork,n,i,f);e.canvas.render(s,e.currentQuery,i,r.BingAtWork);s&&(!e.config.isEdgeNtp&&e._instrumentation&&e._instrumentation.updateRendered(i),e._bingAtWorkWebTelemetry&&(e._bingAtWorkWebTelemetry.setContext({traceId:f.TraceID,tenantId:e.config.bawTenantId}),n.forEach(function(n){e._bingAtWorkWebTelemetry.logShown(n.id)})))},this._bingAtWorkSuggestionsParser.parse(u,n,i,s)))},h.prototype.getAllSuggestionInstUrl=function(n,t){for(var u,f,o=this.getInstrumentationKeys(t),i=[],r=0,e=o;r<e.length;r++)u=e[r],f=this.getSuggestionInstValue(u,!0,n),f!==null&&(i=i.concat(["&",u,"=",f]));return i.join("")},h.prototype.getAllSuggestionInstObject=function(n,t,i){var s,f,r,e,u,o;for(i===void 0&&(i=null),s=this.getInstrumentationKeys(t),f={},r=0,e=s;r<e.length;r++)(u=e[r],o=this.getSuggestionInstValue(u,!1,n),this.config.longquery&&this.isLongQuery&&u==="pq"&&i!==null&&i.length>500)||o!==null&&(f[u]=o);return f},h.prototype.getInstrumentationKeys=function(n){return n?a:o},h.prototype.getSuggestionInstValue=function(n,t,r){var u;r=r||this.canvas.selectedSuggestion;switch(n){case i.SuggestionCount:return this.canvas.currentSuggestionList.length==1&&this.canvas.currentSuggestionList[0]==this.currentQuery?"0-"+this._queryWithCurrentSuggestions.length:this.canvas.currentSuggestionList.length+"-"+this._queryWithCurrentSuggestions.length;case i.PartialQuery:return t?encodeURIComponent(this._queryWithCurrentSuggestions):this._queryWithCurrentSuggestions;case i.SuggestionPosition:return this.config.ascsr?this.canvas.selectedSuggestion?((u=this.canvas.selectedSuggestion)===null||u===void 0?void 0:u.originalIndex)+1+"":"-1":(this.config.mnw&&r&&r.ord>this.canvas.mnwSuggestionsCount&&(r.ord=r.ord-this.canvas.mnwSuggestionsCount),r?""+r.ord:this.config.mnw&&this.isMNWSuggestionSelected(this.canvas.clickedMNWSuggestionType)?this.canvas.clickedMNWSuggestionPosition.toString():"-1");case i.SuggestionType:return r?r.src:this.config.mnw&&this.isMNWSuggestionSelected(this.canvas.clickedMNWSuggestionType)?this.canvas.clickedMNWSuggestionType:"n";case i.SkipValue:return r&&r.sk?r.sk:"";case i.Ghosting:return this.ghostInstValue==0?null:this.ghostInstValue.toString();case i.ConversationId:return _G.IG;case i.GhShown:return this.ghostingShown.toString();case i.GhAccepted:return this.ghostingAccepted.toString();case i.GhPrefixLength:return this.ghostingPrefixLength;case i.LonqQueryParam:return this.isLongQuery?"1":"0";case i.AsCsrVersion:return this.config.sm?this.config.sm:null;default:return null}},h.prototype.isMNWSuggestionSelected=function(n){return n=="MNW"||n=="MNWU"||n=="MNWB"||n=="MNWT"||n=="MNWF"?!0:!1},h.prototype.setCursorPosition=function(n){this._cursorPosition=n},h.prototype.getCurrentCursorPosition=function(){return this._cursorPosition},h.prototype.finalizeKeystroke=function(){this._instrumentation&&this._requestSequence>-1&&(this.config.msbClient==t.msbVerticalClient&&this._instrumentation.createMSBMasterImpression(this._requestSequence),this._instrumentation.finalizeKeystroke(this._requestSequence))},h.prototype.fetch=function(n){var t,i;if(this.finalizeKeystroke(),this._requestSequence++,this._instrumentation&&this._instrumentation.beginRequest(this._requestSequence),this.fetchWeb(n,this._requestSequence,!1),this.config.msbqc&&this.isMsbCachingBundleReady||this.config.isNtpClientqfEnabled)this.fetchMsb(n,this._requestSequence);else if(this.config.msbqc){if(this.config.msbqc&&this.config.bawUserId&&this._msbDataProvider&&!this.isMsbCachingBundleReady)this.onMsbResponseReceived([],this._requestSequence,n,!0,"",null,"CS")}else this.fetchBingAtWork(n,this._requestSequence);this._sydneyDataProviders&&(t=this.config.ascbtop||this.config.ascbnw&&this.canvas.containsNextWord||this.canvas.cbOnTopLastSuggestion,this._sydneyDataProviders.fetch(this.config.isMobile,this.config.ascbiq,t,n,this._requestSequence));this.config.msbSusE&&this.fetchSubstrate(n,this._requestSequence);i=n&&n.length;this._msbEngagementDataProvider&&i>=this.config.MSBMinQueryLengthForEngagementQF&&this._msbEngagementDataProvider.show(n,this._requestSequence)},h.prototype.fetchZeroQF=function(){var n;if(this.config.enableZeroQfWork)if(this.finalizeKeystroke(),this._requestSequence++,this._instrumentation&&this._instrumentation.beginRequest(this._requestSequence),this.fetchWeb("",this._requestSequence,!1),(n=this._sydneyDataProviders)===null||n===void 0?void 0:n.fetchZeroQF(this._requestSequence),this.config.msbqc&&this.isMsbCachingBundleReady||this.config.isNtpClientqfEnabled)this.fetchZeroQf(this._requestSequence);else if(this.config.msbqc&&this.config.bawUserId&&this._msbDataProvider&&!this.isMsbCachingBundleReady)this.onMsbResponseReceived([],this._requestSequence,"",!1,"",null,"ZCS")},h.prototype.fetchSubstrate=function(n,i){if(this._substrateDataProvider&&this.currentQuery.length>=this.config.bawminqlen){var r=t.BingAtWorkTemplateManager.getTenantConfig(this.config);r&&r.displayName&&this._substrateDataProvider.fetch(n,i,!1)}},h.prototype.fetchBingAtWork=function(n,i){if(this._bingAtWorkDataProvider&&this.currentQuery.length>=this.config.bawminqlen){var r=t.BingAtWorkTemplateManager.getTenantConfig(this.config);r&&r.displayName?(this.addBawPayload(n),this._bingAtWorkDataProvider.fetch(n,i,!1)):this.config.isEdgeNtp&&this.msbNtpKeyStrokeMaxRetry>0&&(this.msbNtpKeyStrokeMaxRetry--,this.raiseEvent(21))}},h.prototype.fetchMsb=function(n,i){var r,u,e,f;((r=this._bingAtWorkWebTelemetry)===null||r===void 0?void 0:r.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()&&(e=this._bingAtWorkWebTelemetry.createQfLoggerContext());this._msbDataProvider&&this.currentQuery.length>=this.config.bawminqlen&&(f=t.BingAtWorkTemplateManager.getTenantConfig(this.config),f&&f.displayName&&(((u=this._bingAtWorkWebTelemetry)===null||u===void 0?void 0:u.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()?this._msbDataProvider.fetch(n,i,e):this._msbDataProvider.fetch(n,i)))},h.prototype.fetchZeroQf=function(n){var t,i,r;((t=this._bingAtWorkWebTelemetry)===null||t===void 0?void 0:t.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()&&(r=this._bingAtWorkWebTelemetry.createQfLoggerContext());this._msbDataProvider&&this.currentQuery==""&&(((i=this._bingAtWorkWebTelemetry)===null||i===void 0?void 0:i.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()?this._msbDataProvider.fetchZeroQF(n,r):this._msbDataProvider.fetchZeroQF(n))},h.prototype.addBawPayload=function(n){var r=this.config.bawmax,t,i;this._isBawPayloadAdded?this._bingAtWorkDataProvider.addPostValue("Query",n):(t=["Bookmark","Qna","Building"],this.config.msbSusR||t.push("Person"),i={count:r,domains:t,query:n,conversationId:_G.IG},this._bingAtWorkDataProvider.addBody(i))},h.prototype.onSearchBoxFocusWithRetry=function(n,t,i,r){var u=this;if(t!==this.currentQuery){r&&r();return}this.canvas.searchBoxHasFocus()?i():n<5&&sb_st(function(){u.onSearchBoxFocusWithRetry(n+1,t,i,r)},15)},h.prototype.fetchWeb=function(n,t,u){var f,e,o;this.config.msbnocons&&this._receivedAtLeastOnceValidResponse?this.canvas.render(this._emptyWebSuggestionsResponse,this.currentQuery,t,r.Web):(this._dataProvider.addParam(i.CursorPosition,this._cursorPosition.toString()),this._container!=null&&this._container.parentNode!=null&&(f=this._container.parentNode.offsetWidth.toString(),this.config.cors?this._dataProvider.addParam("contentWidth",f):this._dataProvider.addHeader("X-Autosuggest-ContentWidth",f)),_ge("sidebar_search_experience")&&this._dataProvider.addHeader("X-SIDEBAR-SEARCH","true"),this._receivedAtLeastOnceValidResponse&&(!this.config.aszisear||n!=="")||this.config.ascssdis||this.config.ascsr||this._dataProvider.addParam(i.Css,"1"),this.config.ascsr&&this._dataProvider.addParam(i.Csr,"1"),this.config.sm&&this._dataProvider.addParam(i.AsCsrVersion,this.config.sm),n===""&&this.config.zisr1>0&&(e=this.checkSuggestionTypeForRanking(),e!=""&&this._dataProvider.addParam("zisBD",e)),!this.config.ascsr&&(this.config.ezis&&this._originalQuery===n&&this._requestSequence==0||this.config.aszisear&&n==="")&&this._dataProvider.addParam(i.ZeroInputSerp,"1"),this.config.ascsr&&this.config.ezis&&this._originalQuery===n&&this._dataProvider.addParam(i.ZeroInputSerp,"1"),this.config.pc&&this._dataProvider.addParam("pubcode",this.config.pc),this.config.footnote&&this._dataProvider.addParam("footnote","1"),this.config.longquery&&this.isLongQuery&&this._dataProvider.addParam("lq","1"),this.config.adcached&&this._adCachedQuery&&this._adCachedImpressionGuid&&(this._dataProvider.addParam("adq",this._adCachedQuery),this._dataProvider.addParam("adig",this._adCachedImpressionGuid)),this.config.pcov&&(o=this.getPartnerCodeOverride(),o&&this._dataProvider.addParam("pc",o)),(this.config.ascsr&&!this.config.enableCSRForBAW||this._msbDataProvider==null&&this._bingAtWorkDataProvider==null)&&this._dataProvider.addParam("msbqf","false"),this.config.IsBingPrivate&&!this.config.cors&&this._dataProvider.addHeader("preferAnonymous","1"),this.config.enableRequeryParam&&!this.hasPrefixQueryBeenUpdated&&this._dataProvider.addParam("rqry","1"),this.config.isPathSearch&&this._dataProvider.addParam("pths","1"),this.config.ascsr&&this.attemptLoadingCsrBundles(),this.config.asprefre||this.config.asprefrev2?(this.raiseEvent(7,this.currentQuery,t),this._dataProvider.fetch(n,t,!0)):(this._dataProvider.fetch(n,t,!0),this.raiseEvent(7,this.currentQuery,t)),u||sj_evt.fire("AS.RequestSent",this.currentQuery))},h.prototype.registerAjaxSerpUnloadEvent=function(){var n=this,t=function(i){var r=i&&i[1];r&&r.isInstantRequest||(n._isDisposed=!0,sj_evt.unbind(e,t),n.raiseEvent(17),n.clearEvents())};sj_evt.bind(e,t,!1)},h.prototype.getPartnerCodeOverride=function(){var n,t=(n=_ge(this.config.f))===null||n===void 0?void 0:n.querySelector("[name='pc']"),r=t&&t.value,u=_d.location.href.indexOf("ntp.msn.com/edge/ntp")>=0||_d.location.href.indexOf("ntp.msn.cn/edge/ntp")>=0,i;return!r&&u&&(i="U531"),i},h.prototype.setRawQuery=function(n){this.canvas.updateRawQuery(n)},h.prototype.setQuery=function(n){if(this._cacheZisEarly=!1,this.config.enableRequeryParam&&n!==undefined&&(this.previousQuery=this.currentQuery!==""?this.currentQuery:this.previousQuery),this.currentQuery=n,this.config.enableRequeryParam&&n!==undefined&&(this.hasPrefixQueryBeenUpdated=this.previousQuery==""||this.hasPrefixQueryBeenUpdated||this.previousQuery!==undefined&&this.previousQuery.toLowerCase()!==this.currentQuery.toLowerCase()),typeof n=="undefined"||n.length==0&&!this.config.fetchOnEmpty){this.fetchZeroQF();return}this.fetch(n)},h.prototype.pretechQuery=function(n){this._cacheZisEarly=!0;this.fetchWeb(n,0,!0)},h.prototype.setAdCachedQuery=function(n,t){this._adCachedQuery=n;this._adCachedImpressionGuid=t},h.prototype.appendLatency=function(n){this.networkLatencyInfo=this.data&&this.data.Inst?this.networkLatencyInfo==""?this.data.Inst.IG+":"+n:this.networkLatencyInfo+"&"+this.data.Inst.IG+":"+n:this.networkLatencyInfo==""?n:this.networkLatencyInfo+"&"+n},h.prototype.checkSuggestionTypeForRanking=function(){for(var i="",n=0;n<t.ZisRankableBanners.length;n++)this.checkClicksOrExpirty(t.ZisRankableBanners[n])&&(i=i!=""?i+","+t.ZisRankableBanners[n]:t.ZisRankableBanners[n]);return i},h.prototype.checkClicksOrExpirty=function(n){var r=t.Utils.getItem(n),i,u;try{if(r){if(i=JSON.parse(r),u=new Date,i&&u.getTime()>i.expiry)return t.Utils.removeItem(n),!1;if(i&&i.value>=this.config.zisr1)return!0}return!1}catch(f){return!1}},h.prototype.attemptLoadingCsrBundles=function(){this.config.csr_precompbootstrap||typeof sa_preactcompsloader=="undefined"||this.preactComponentsLoaded||(sa_preactcompsloader(),this.preactComponentsLoaded=!0)},h.prototype.LogPerformanceTiming=function(n){n.forEach(function(n){var t=performance.getEntriesByName(n);t&&t[0]&&Log.Log(n,"AS","PerfInst",!1,"LoadTime",t[0].startTime.toString())})},h.ScopeExtensions=[],h}(t.EventRegisterer);t.WebCore=s})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){function i(n,t,i){Log.Log(n,"AS","PerfInst",i,"Meta",t)}function f(n,t,i){Log.Log(n,"AS","MSBInst",i,"Meta",t)}function r(n,t,i,r){Log.Log(n,"AS","Ghosting",r,"Namespace","AutoSuggest","EventType",t,"CustomData",i)}function t(n,t){var i="q:"+n;return t&&(i+=",i:"+t),i}var u=function(){function u(){}return u.prototype.init=function(t){var i,r;this._coreInstance=t;i=new n.EventRegistration(this);i.add(18,this.onTextChanged);i.add(7,this.onRequestSent);i.add(9,this.onValidResponseReceived);i.add(31,this.OnGhostingEventFired);i.add(10,this.onSuggestionsRendered);i.add(26,this.onGhostingShown);i.add(27,this.onGhostingAccepted);i.add(34,this.logMSBSuggestionCount);t.registerEvents(i);t.internalEventTrigger&&(r=new n.EventRegistration(this),r.add(10,this.onSuggestionsRendered),t.internalEventTrigger.registerEvents(r))},u.prototype.onGhostingShown=function(n,t){var i='{"PL":'+n+', "GL":'+t;this._coreInstance.data&&this._coreInstance.data.Inst&&this._coreInstance.data.Inst.IG&&(i=i+', "IG":"'+this._coreInstance.data.Inst.IG+'"');i=i+"}";r("SystemEvent","TextGhostingSuggest",i,!1)},u.prototype.onGhostingAccepted=function(n,t,i){var u='{"PL":'+n+', "GL":'+t+', "AM":"'+i+'"';this._coreInstance.data&&this._coreInstance.data.Inst&&this._coreInstance.data.Inst.IG&&(u=u+', "IG":"'+this._coreInstance.data.Inst.IG+'"');u=u+"}";r("InteractionEvent","TextGhostingAccept",u,!1)},u.prototype.onTextChanged=function(n,r){i("Change",t(n,r),!1)},u.prototype.OnGhostingEventFired=function(n,r){i("GhostingLatency",t(n,r),!1)},u.prototype.onRequestSent=function(n,r){i("Request",t(n,r),!1)},u.prototype.logMSBSuggestionCount=function(n,t,i){var r="q:"+n;i&&(r+=",i:"+i);r+=",cnt:"+t;f("MSBSuggestionCount",r,!1)},u.prototype.onValidResponseReceived=function(i,r,u,f){u==n.DataSources.Web&&Log.Log("Load","AS","PerfInst",!1,"Meta",t(i,r),"AsResponseLength",f!==null&&f!==void 0?f:"")},u.prototype.onSuggestionsRendered=function(i,r,u,f,e){var o,s;e==n.DataSources.Web&&(o=t(i,u),this._coreInstance.data&&this._coreInstance.data.Inst&&this._coreInstance.data.Inst.IG&&(o+=",ig:"+this._coreInstance.data.Inst.IG),s=this.CheckAnswerPresent(r),Log.Log("Show","AS","PerfInst",!1,"Meta",o,"AnswerInfo",s))},u.prototype.CheckAnswerPresent=function(n){if(n!==null&&n!==undefined&&n[0]!==null&&n[0]!==undefined){var t=n[0];if(this._coreInstance.config.ascsr&&t.t&&t.q&&t.q!==undefined)return t.t+";"+t.q.length;if(!this._coreInstance.config.ascsr&&t.stype&&t.query&&t.query!==undefined)return t.stype+";"+t.query.length}return null},u}();n.PerfInst=u;n.WebCore.ScopeExtensions.push(new u)})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var u=AutoSuggest.Service.QueryParams,t="sa_errorCnt",i=function(){function n(){this._callParams={};this._callHeaders={};this._callBody={}}return n.prototype.fetchUrl=function(){},n.prototype.init=function(n,t,i){this._config=n;this._baseUrl=t;this._callbackFunc=i},n.prototype.addParam=function(n,t){this._callParams[n]=t},n.prototype.addHeader=function(n,t){if(this._config.cors)throw"Custom headers are not allowed for cross domain calls";this._callHeaders[n]=t},n.prototype.addPostValue=function(n,t){this._callBody[n]=t},n.prototype.addBody=function(n){this._callBody=n},n.prototype.fetch=function(n,t,i){this._requestSequence=t;var r=this.getFinalFetchUrl(n);this.fetchUrl(r,n,t,i)},n.prototype.getBaseUrl=function(){return this._baseUrl},n.prototype.isPostCall=function(){return this._callBody&&typeof this._callBody=="object"&&Object.keys(this._callBody).length>0},n.prototype.getFinalFetchUrl=function(n){var i=decodeURIComponent(this.getBaseUrl())+encodeURIComponent(n),t;this.addParam(u.ConversationId,_G.IG);this._config.adform&&this.addParam("form",this._config.adform);for(t in this._callParams)i+="&"+t+"="+this._callParams[t];return this._callParams={},i},n}(),r;n.DataProviderBase=i;r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.fetchUrl=function(i,r,u,f){var o=this,s,e,h,c;if((this._config.asprefre||this._config.asprefrev2)&&typeof sa_storage!="undefined"&&sa_storage.hasOwnProperty(r)&&sa_storage[r]!==null&&sa_storage[r]!==undefined)s=sa_storage[r],this._callbackFunc(s.responseText,u,r,i,null,s.status,s.getResponseHeader("content-length"));else{e=sj_gx();e.open(this.isPostCall()?"POST":"GET",i,!0);for(h in this._callHeaders)e.setRequestHeader(h,this._callHeaders[h]);this._callHeaders={};e.onreadystatechange=function(){var s,n,h,c,l;if(e.readyState==4){if(e.onreadystatechange=function(){},s=void 0,n=e.status,n==200?s=e.responseText:_w[t]&&(n==0||(n/100|0)==4||(n/100|0)==5)&&(s=_w[t]),h=null,f&&(!o._config.cors||o._config.rbhc)&&e.getResponseHeader&&(h=e.getResponseHeader("X-BingQF-BLIS")),o._config.instHeader&&e.getResponseHeader&&(c=e.getResponseHeader("X-BingQF-It"),c))try{l=JSON.parse(c);l.Inst&&sa_inst.setData(l)}catch(a){}o._callbackFunc(s,u,r,i,h,n,e.getResponseHeader("content-length"))}};e.withCredentials!==undefined&&(e.withCredentials=!0);this.isPostCall()?(c=n.Utils.safeExecute(function(){return JSON.stringify(o._callBody)},""),e.send(c)):e.send()}},r}(i);n.DataProvider=r})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=n.Utils,i=function(i){function r(n){var t=i.call(this)||this;return t.internalEventTrigger=n,t.currentSuggestionList=[],t}return __extends(r,i),r.prototype.init=function(i,r,u,f){var o,e;this.autoSuggestInstance=i;this.config=r;this.container=u;o=new n.EventRegistration(this);o.add(17,this.clearEvents);this.autoSuggestInstance.registerEvents(o);this.isRtl=t.GetComputedStyle(sj_b).direction=="rtl";this._searchBox=f;this.internalEventTrigger&&(e=new n.EventRegistration(this),e.add(19,this.setSelectedSuggestion),e.add(10,this.handleSuggestionsRendered),e.add(11,this.handleNoSuggestionsRendered),this.internalEventTrigger.registerEvents(e))},r.prototype.searchBoxHasFocus=function(){return typeof this._searchBox!="undefined"&&typeof this._searchBox.getRootNode=="function"?this._searchBox.getRootNode().activeElement===this._searchBox:_d.activeElement==this._searchBox},r.prototype.setSelectedSuggestion=function(n,t){this.selectedSuggestion=n||null;this.clickedSuggestion=t?n:null},r.prototype.handleSuggestionsRendered=function(n,t){t=t;this.currentSuggestionList=t.length==1&&t[0].t=="SYC"?[]:t.map(function(n){return n.q});this.setSelectedSuggestion(undefined,!1)},r.prototype.handleNoSuggestionsRendered=function(){this.currentSuggestionList=[];this.setSelectedSuggestion(undefined,!1)},r.prototype.render=function(){},r.prototype.updateRawQuery=function(){},r.prototype.decorateSuggestion=function(){},r.prototype.selectItem=function(){},r.prototype.clearSelectedSuggestion=function(){},r.prototype.onMouseDownSuggestion=function(){},r.prototype.onMouseUpSuggestion=function(){},r.prototype.highlightSuggestion=function(){},r.prototype.unHighlightSuggestionHandler=function(){},r}(n.EventRegisterer);n.CsrClientState=i})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i="sa_nw",r=/(\s|^)sa_nw/g,u="sa_msn_nw",f=/(\s|^)sa_msn_nw/g,t=36,e=function(){function e(t,i,r){this.config=t;this._container=i;this._canvas=r;this._isRtl=n.Utils.GetComputedStyle(sj_b).direction=="rtl";this._isRtl&&this._container.setAttribute("dir","rtl");var u=document.querySelector(".sa_as");this._searchBoxElem=_ge(t.i);this._outerContainer=u?u:sj_ce("div","","sa_as");this._outerContainer.setAttribute("data-priority","2");this._outerContainer.setAttribute("aria-live","polite");this.hide();this._container.appendChild(this._outerContainer)}return e.prototype.getSuggestionsDrawer=function(){return this._outerContainer},e.prototype.show=function(){this._outerContainer.style.display="block"},e.prototype.hide=function(){this._outerContainer.style.display="none"},e.prototype.setMargin=function(n,i){var r=0,u=0;return this.config.searchBoxSpyglass&&(r=this._isRtl?t:t*-1,u=this._isRtl?t*-1:t),this._isRtl?[i+u,n+r]:[n+u,i+r]},e.prototype.update=function(){var l,t,o,e=n.Utils.GetComputedStyle(this._container.parentNode),a,v,h;if(this.config.eNw&&this._canvas.resizeNextWord&&this._canvas.containsNextWord&&this._canvas.largestNextWordElement){this.setMargins(0,0);a=n.Utils.GetComputedStyle(this._searchBoxElem);sj_evt.fire("AS.Layout.NextWord.Show");n.Utils.AddClassName(this._outerContainer,i);this.config.enforceMsnNWStyle&&n.Utils.AddClassName(this._outerContainer,u);v=this._outerContainer.style.display;this.setCanvasVisibility("hidden","block");var s=this._canvas.largestNextWordElement,y=n.Utils.GetTextContent(s),c=this.getFirstChild(s),w=s.query.replace(y,""),b=c&&c.innerHTML.indexOf("<strong>")>-1,k=n.Utils.CalcWidth(s,c&&c.textContent||y,null,b),d=n.Utils.CalcWidth(s,w,a.fontSize);this.config.IsBingPrivate&&(h=_ge("as_foot"),t!=0||o!=0?h!=null&&(h.style.display="none"):h!=null&&(h.style.display="list-item"));var g=_ge(this.config.f)?_ge(this.config.f).offsetWidth:Number.MAX_VALUE,nt=_ge("sa_ul")?_ge("sa_ul").offsetWidth:Number.MAX_VALUE,p=document.querySelector("#sb_form .b_logoArea"),tt=p?p.offsetWidth:0;t=Math.min(d+4,g-(nt+tt+12));o=this._outerContainer.offsetWidth-t-k-this.getNwExtraSz(s)-4;l=this.setMargin(t,o);t=l[0];o=l[1];this.setCanvasVisibility("",v)}else sj_evt.fire("AS.Layout.NextWord.Hide"),n.Utils.RemoveClassName(this._outerContainer,r),this.config.enforceMsnNWStyle&&n.Utils.RemoveClassName(this._outerContainer,f),this._isRtl?(o=(this.toFloat(e.paddingRight)+this.toFloat(e.borderRightWidth))*-1,t=this.toFloat(e.borderLeftWidth)-this.toFloat(e.paddingLeft)):(t=(this.toFloat(e.paddingLeft)+this.toFloat(e.borderLeftWidth))*-1,o=this.toFloat(e.borderRightWidth)-this.toFloat(e.paddingRight));this.setMargins(t,o);this._searchBoxElem!=null&&this._searchBoxElem.dir.length>0&&(this._outerContainer.dir=this._searchBoxElem.dir)},e.prototype.toFloat=function(n){var t=parseFloat(n);return isNaN(t)?0:t},e.prototype.setCanvasVisibility=function(n,t){this._outerContainer.style.visibility=n;this._outerContainer.style.display=t},e.prototype.setMargins=function(n,t){this._container.style.marginLeft=n+"px";this._container.style.marginRight=t+"px"},e.prototype.getFirstChild=function(n){return n&&n.childNodes&&n.childNodes.length>0&&n.childNodes[0]},e.prototype.getNwExtraSz=function(t){var r=this.getFirstChild(t),i;return r?(i=n.Utils.GetComputedStyle(r),this.toFloat(i.marginLeft)*2+this.toFloat(i.borderLeft)+this.toFloat(i.borderRight)):0},e}();n.Layout=e})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){function h(n){return typeof n=="number"?n:'"'+n.replace(/"/g,'\\"')+'"'}var c="SRCHHPGUSR",l="AS",u=4,t="AS.CurrentImpressionQuerySelected",f="AS.GlobalShowDropDown",e="bawh",i=sb_ie&&sb_de.style.opacity===undefined,o=-1,r=!1,s,a=function(a){function v(t,i,u){var f=a.call(this)||this,e,s,h;for(f.config=t,f.autosuggest=i,f.internalEventTrigger=u,f._pollInterval=0,f._pendingRequestCount=0,f._bRequeryOnTextChange=!0,f._hiddenFields=[],f._lastQuery="",f._lastRawQuery="",f._showAsdropdown=!0,f._trimRegex=new RegExp("^\\s*","g"),f._removeSpacesRegex=new RegExp("\\s+","g"),f._lastTextChanged="",f._textChangeSequence=0,f._isSearchBoxWebComponent=!1,f._asContainer=f.getContainer(),f.debounceTimeout=null,f.debounceDelay=40,f.focusHistory=function(n){var t=_ge("as_foot");if(t&&t.style.display!="none"){f.autosuggest.canvas.clearSelectedSuggestion();f.autosuggest.canvas.searchTypeDivIndex=0;var i=t.querySelector(".as_rmhswarning.out_fd_side a"),u=t.querySelector(".as_bpr.as_bprtxt a"),r=i?i:u;if(r!=null){r.focus();n.preventDefault();return}}f.hideDropDownOnFocusChange()},f.onBlur=function(){var n=!_ge("fbpgdg");n&&document.activeElement.id=="sd_fdb"&&(f.autosuggest.canvas.clearSelectedSuggestion(),f.hideDropDownOnFocusChange(),_ge("sb_form_q").focus())},f.focusFeedback=function(n){var t=_ge("sb_fdb");if(t&&t.style.display!="none"){f.autosuggest.canvas.clearSelectedSuggestion();f.autosuggest.canvas.searchTypeDivIndex=0;t.focus();t.onblur=f.onBlur;n.preventDefault();return}f.hideDropDownOnFocusChange()},f.onScrollHandler=function(){f.searchBox&&f._asSubContainer&&(f.searchBox.blur(),sj_ue(f._asSubContainer,"scroll",f.onScrollHandler))},f.searchBoxTouchAction=function(){f.config.handleClickOnly||f.config.handleDuplicateFetch&&f._lastClickQuery==f.getCurrentQuery(!0)||(f.autosuggest.canvas.searchBoxHasFocus()||f.searchBox.focus(),f.onSearchBoxClick(),f._lastClickQuery=f.getCurrentQuery(!0))},f.addSearchBoxLeftSpyglass=function(){var n=_ge("sb_leftsg"),t;n||(n=sj_ce("div","sb_leftsg"),n.style.display="none",f.searchBox.parentNode.insertBefore(n,f.searchBox));n.innerHTML===""&&(t='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 25 25"><path stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" fill="none" d="M23.75 23.75l-9-9"><\/path><circle stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" cx="9" cy="9" r="7.75" fill="none"><\/circle><path fill="none" d="M25 25h-25v-25h25z"><\/path><\/svg>',n.innerHTML=t)},f.searchBoxClickAction=function(){f._lastClickQuery==f.getCurrentQuery(!0)&&f.autosuggest.canvas.searchBoxHasFocus()||(f.searchBox.focus(),f.config.handleDuplicateFetch&&(f._lastClickQuery=f.getCurrentQuery(!0)),f.onSearchBoxClick());f.config.handleDuplicateFetch||(f._lastClickQuery=null)},f.onSubmit=function(n){var i,r,u,t;if(f.cancelDefaultHandler(n),!f.config.ascontainer&&f.config.ghostingWithGreyText&&f._ghostingText&&f.searchBox.value==f._prefixText&&(i=f._ghostingText.length,r=f._prefixText.length,f.searchBox.value=r-i>0?f._prefixText.slice(0,r-i):f._prefixText,f._ghostingText=null),f.isEmptyQuery()){u=_w._H&&_w._H.sbeb;u&&sb_st(function(){return f.hideDropDown(2)},5);return}if(sb_st(function(){return f.hideDropDown(2)},5),t=f.autosuggest.canvas.selectedSuggestion,sj_evt.fire("AS.Navigate",t,"submit"),t)f.config.ascsr?(t=t,f.navigateJSON(t.id,t.q,t.u,!0)):f.navigate(t,!0,f.config.linkTarget);else{f.submitForm(!0);f.autosuggest.onBfbSearchBoxAction("SearchDone")}},f.onSearchBoxKeyDown=function(n){var s,h,u=n.keyCode,c,t,e,a,i;f._ghostingText=null;c=(u==38||u==40)&&o==229&&!r;t=document.querySelector(".sa_hv");switch(u){case 13:if(f.config.enableNewlineByShiftEnter){if(f.config.submitOnEnter&&!n.shiftKey){f.onSubmit(n);break}n.shiftKey&&_w.Log&&Log.Log&&Log.Log("Autosuggest","SerpSearchBoxKeyDown","ShiftEnter");break}if(f.config.submitOnEnter)f.onSubmit(n);break;case 27:f.isQueryGhosted()||(f.hideDropDown(1),f.cancelDefaultHandler(n));break;case 38:f._isLayoutVisible&&(f.config.waitForCompositionEnd&&c?f.imeCheckForJapanese():f.config.ascsr?(f.searchBox.focus(),sj_evt.fire("AS.KeyBoardUp"),f.onEntitySugSelection()):f.autosuggest.canvas.selectItem(0),f.cancelDefaultHandler(n));break;case 40:f._isLayoutVisible?f.config.waitForCompositionEnd&&c?f.imeCheckForJapanese():f.config.ascsr?(f.searchBox.focus(),sj_evt.fire("AS.KeyBoardDown"),f.onEntitySugSelection()):f.autosuggest.canvas.selectItem(1):f.config.fetchOnDownArrowKey&&f.fetchForCurrentQuery();break;case 37:f._isLayoutVisible&&(f.config.ascsr&&f.config.enableEASE&&t?(sj_evt.fire("AS.KeyBoardLeft"),n.preventDefault(),f.onEntitySugSelection()):f.config.enableEASE&&f.config.enblEASEKB&&!f.autosuggest.canvas.hasAsExpanded&&!f.autosuggest.canvas.trendingNowMovedToRight&&t&&f._isLayoutVisible&&f.autosuggest.canvas.searchTypeDivIndex>=0&&(f.autosuggest.canvas.selectItem(3),e=document.querySelector(".sa_hv"),t!==e&&n.preventDefault()));break;case 39:f._isLayoutVisible&&(f.config.ascsr&&f.config.enableEASE&&t?(sj_evt.fire("AS.KeyBoardRight"),n.preventDefault(),f.onEntitySugSelection()):f.config.enableEASE&&f.config.enblEASEKB&&!f.autosuggest.canvas.hasAsExpanded&&!f.autosuggest.canvas.trendingNowMovedToRight&&t&&f._isLayoutVisible&&f.autosuggest.canvas.searchTypeDivIndex>=0&&(f.autosuggest.canvas.selectItem(2),e=document.querySelector(".sa_hv"),t!==e&&n.preventDefault()));break;case 9:f._searchDivs=document.querySelectorAll("#sa_ul");t=document.querySelector(".sa_sg.sa_ent.sa_hv");f._searchChildDiv=t?(s=t.lastElementChild)===null||s===void 0?void 0:s.querySelectorAll(".sa_sugg"):undefined;var v=f._searchDivs.length-1,y=f._searchChildDiv?f._searchChildDiv.length-1:0,l=f.autosuggest.canvas.searchTypeDivIndex,p=_ge("as_foot");if(!f.isQueryGhosted()){if(n.shiftKey){f._isLayoutVisible&&l>0&&f.config.enableAsPanelExpansion?(f.autosuggest.canvas.selectItem(3),n.preventDefault()):f.hideDropDownOnFocusChange();break}if(f._isLayoutVisible&&l<v&&f.config.enableAsPanelExpansion||f.config.enableEASE&&!f.config.enblEASEKB&&f._isLayoutVisible&&f._searchChildDiv!==undefined&&l<y){f.autosuggest.canvas.selectItem(2);n.preventDefault();break}if(f.config.CommonFooter==!0&&f._isLayoutVisible&&p!=null&&f.gaNtp(document.activeElement).id==f.config.i){f.focusHistory(n);break}if(f.config.removeSuggUrl&&f._isLayoutVisible&&((h=document.activeElement)===null||h===void 0?void 0:h.className)!=="sa_rm"){if(a=f.autosuggest.canvas.selectedSuggestion,!a){f.hideDropDownOnFocusChange();break}if(i=f.getSelectedSuggestionRemoveButton(),i){i.tabIndex=0;i.focus();i.onblur=f.onBlur;n.preventDefault();break}}f.focusFeedback(n)}}o=u},f.onASKeyDown=function(n){var t,i,r,u,e=_ge("sb_fdb"),o=_ge("as_foot"),s=n.keyCode;s==9&&(n.shiftKey?f._isLayoutVisible&&f.gaNtp(document.activeElement).id=="sb_fdb"&&o?f.focusHistory(n):(f.hideDropDownOnFocusChange(),_ge(f.config.i).focus(),n.preventDefault()):f.config.ascsr&&((t=document.activeElement)===null||t===void 0?void 0:t.id)=="as_foot_link"&&e?f.focusFeedback(n):(f.gaNtp(document.activeElement).className=="as_rmhswarningtxt"||((r=(i=f.gaNtp(document.activeElement))===null||i===void 0?void 0:i.parentElement)===null||r===void 0?void 0:r.className)=="as_bpr as_bprtxt")&&e?f.focusFeedback(n):((u=n.target)===null||u===void 0?void 0:u.className)!=="sa_rm"&&(f.hideDropDownOnFocusChange(),_ge(f.config.i).focus(),n.preventDefault()))},f.getSelectedSuggestionRemoveButton=function(){var u,t=f.autosuggest.canvas.selectedSuggestion,n,i,r;return t?(f.config.ascsr&&(t=document.getElementById(t.id)),n=t.firstElementChild,!n)?null:n.classList&&n.classList.contains("as_hr")?n:(i=n.lastElementChild,i&&i.classList&&i.classList.contains("sa_rm"))?i.firstElementChild:(r=t.nextElementSibling,r&&((u=r.classList)===null||u===void 0?void 0:u.contains("sa_rm")))?r:null:null},f.setshowAsDropDownValue=function(n){f._showAsdropdown=n;f.autosuggest.isLongQuery=!n},f.onSearchBoxClick=function(){f._ghostingText=null;var t=f.config.asbugfix?f._showAsdropdown:!0;f._isLayoutVisible||f.suppressRequestForQuery||!t||f.fetchForCurrentQuery();f.autosuggest.onBfbSearchBoxAction(n.searchBoxFocusEventId)},f.onEntitySugSelection=function(){var t,n=(t=f.autosuggest.canvas)===null||t===void 0?void 0:t.selectedSuggestion,i;f.config.selectEntity&&f.isJSONSuggestion(n)&&n.t==="MB"&&(i='{ "q": "'.concat(n.q,'", "t": "').concat(n.t,'"}'),Log.Log("entitySugKey","AS","EASEInst",!1,"Namespace","AutoSuggest","EventType","Hide","CustomData",i))},f.hideDropDownOnFocusChange=function(n){f.hideDropDown(1,n);f._showAsdropdown==!1&&f.config.ascontainer&&f.raiseEvent(30)},f.onTextInput=function(){var n=f.searchBox.value;f.triggerTextChangedEvent(n)},f.clearSearchBox=function(n){f.clearQuery();f.searchBoxClickAction(n)},f.raiseEvent(5,t),e=0,s=v.ScopeExtensions;e<s.length;e++)h=s[e],h.init(f);return v.ScopeExtensions=[],f}return __extends(v,a),v.prototype.init=function(t){var l=this,h,o,s,u,c,a,i,f,e;(this.config.globalId=t,this.config.slid="sa_ul",this._bDisabled=this.isDisabled())||(_w._H&&_w._H.ajax?(h=_ge("serpHeader"),h&&(o=h.getElementsByTagName("form"),o&&o.length>0&&(this.searchForm=o[0],s=this.searchForm.getElementsByClassName("b_searchbox"),s&&s.length>0&&(this.searchBox=s[0])))):(this.searchForm=_ge(this.config.f),this.searchBox=_ge(this.config.i)),this.searchBox&&typeof this.searchBox.shadowRoot!="undefined"&&(this._isSearchBoxWebComponent=!0),this.searchForm&&this.searchForm.form&&(this.config.fc=this.searchForm.form.value),this._currentImpressionQuery=this.searchBox.value,u=this.getContainer(),!u&&_w.sa_initAsC&&typeof _w.sa_initAsC=="function"&&(_w.sa_initAsC(),u=this.getContainer()),sj_be(u,"mousedown",function(n){return sj_sp(n)}),u.style.display="block",this.layout=this._layout=new n.Layout(this.config,u,this.autosuggest.canvas),this.layout.update(),this.registerUIElement(u),this.registerUIElement(this.searchBox),this.config.asmobfw&&(this._asSubContainer=document.querySelector(".sa_as"),this._asSubContainer&&this.searchBox&&sj_be(this.searchBox,"focus",function(){sj_be(l._asSubContainer,"scroll",l.onScrollHandler)})),c=_ge("sb_form_go"),c&&this.registerUIElement(c),this._pollInterval=this.config.d,this._pollThrottlingEnabled=this.config.t,a=this._layout.getSuggestionsDrawer(),this.autosuggest.init(this.config,a,this.searchBox),this._lastQuery=this.getQueryToFetch(),this.config.aszisear&&this.loadZisEarly(),this.searchBox.setAttribute("aria-autocomplete","both"),this.config.dsarialv||this.searchForm.setAttribute("aria-live","polite"),i=new n.EventRegistration(this),i.add(8,this.handleResponseReceived),i.add(11,this.startNoMatchTimeout),i.add(10,this.showDropDown),i.add(12,this.onUpdateText),i.add(13,this.onUpdateTextAndRequery),i.add(14,this.onUpdateGhostedText),i.add(4,this.navigate),i.add(17,this.dispose),this.autosuggest.registerEvents(i),this.internalEventTrigger&&(f=new n.EventRegistration(this),f.add(12,this.onUpdateText),f.add(4,this.navigateJSON),f.add(10,this.showDropDown),f.add(11,this.startNoMatchTimeout),this.internalEventTrigger.registerEvents(f)),this.bindEvents(sj_be,sj_evt.bind),this.config.asdbc?this.debouncingAutosuggest():this.pollForQueryChange(),this.raiseEvent(6,this),this.config.ascontainer&&(e=document.querySelector("textarea#".concat(this.config.i)),e&&(e===null||e===void 0?void 0:e.rows)>1&&this.setshowAsDropDownValue(!1)),this.config.waitForCompositionEnd&&(this.searchBox.addEventListener("compositionend",function(){r=!0}),this.searchBox.addEventListener("compositionstart",function(){r=!1})))},v.prototype.setData=function(n){this.autosuggest.setData(n)},v.prototype.getCurrentImpressionQuery=function(){return this._currentImpressionQuery},v.prototype.isDisabled=function(){return!this.config.pv&&sj_cook.get(c,l)=="0"},v.prototype.registerUIElement=function(n){sj_be(n,"touchend",sj_sp);sj_be(n,"click",sj_sp)},v.prototype.addHiddenField=function(n,t){var i=sj_ce("input");return i.id="sa_"+n,i.name=n,i.value=t,i.type="hidden",this.searchForm.appendChild(i),this.config.sbt&&this._hiddenFields.push(i),i},v.prototype.cancelDefaultHandler=function(n){sj_sp(n);sj_pd(n)},v.prototype.loadZisEarly=function(){this.autosuggest.pretechQuery("")},v.prototype.show=function(){this.config.handleDuplicateFetch&&this._lastClickQuery!=this.getCurrentQuery(!0)&&(this._lastClickQuery=this.getCurrentQuery(!0));this.onSearchBoxClick()},v.prototype.getCursorPosition=function(){return n.Utils.getCursorPosition(this.searchBox,!0)},v.prototype.makeAutoSuggestGPingCall=function(n){var r,u,i=_ge(n.replace("&","")),o;if(i&&document.images){var e=i.getAttribute("h"),f=void 0,t={a:[],add:function(n,t){this.a.push(h(n)+":"+h(t))},get:function(){return this.a.length?"&PR={"+this.a.join(",")+"}":""}};this.config.ascsr&&this.config.isMobile&&(i.it="t");t.add("i",this.autosuggest.canvas.clickedSuggestion?i.it||"m":"k");this.autosuggest.ghostInstValue&&t.add("ghc",this.autosuggest.ghostInstValue);i.panel?t.add("et",sb_gt()-i.panel.ot):this.config.ascsr&&((u=(r=this.autosuggest.canvas.clickedSuggestion)===null||r===void 0?void 0:r.panel)===null||u===void 0?void 0:u.ot)&&t.add("et",sb_gt()-this.autosuggest.canvas.clickedSuggestion.panel.ot);this.autosuggest.ghostingShown&&t.add("ghsh",this.autosuggest.ghostingShown.toString());this.autosuggest.ghostingAccepted&&t.add("ghacc",this.autosuggest.ghostingAccepted.toString());this.autosuggest.ghostingPrefixLength&&t.add("ghpl",this.autosuggest.ghostingPrefixLength.toString());f=this.autosuggest.data&&this.autosuggest.data.Inst?this.autosuggest.data.Inst.IG:null;f&&e&&(o=new Image,o.src=this.getGPingUrl()+"IG="+f+"&"+e+t.get())}return!0},v.prototype.getGPingUrl=function(){return _w&&_w.location&&_w.location.host&&_w.location.host.indexOf("bing.com")>-1&&_G.gpUrl?_G.gpUrl:"https://www.bing.com"+_G.gpUrl},v.prototype.navigate=function(t,i,r){var o=this,u,f;if(sb_st(function(){return o.hideDropDown(2)},5),this.config.zisr1>0&&n.ZisRankableBanners.indexOf(t.stype)!=-1&&this.updateLSOnClick(t.stype),this.makeAutoSuggestGPingCall(t.id),f=t.query,t.rg?this.updateSearchBoxValue(this.getLastRequestedQuery()):f!=undefined&&this.updateSearchBoxValue(f),this.config.logClickOnSuggestion&&(i?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","EnterClick",!1):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","MouseClick",!1)),this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&this.logAutoSuggestNetworkLatency(),this.config.sbt&&t.addInst&&!t.nav){if(this.submitForm(i,t.url),this.config.isNtpClientqfEnabled)this.autosuggest.onBfbNavigateCallback(t.id,t.stype,((u=t.parentElement)===null||u===void 0?void 0:u.id)==e&&this.config.isLowConfidenceWeb,t.query,t.getAttribute("logicalId"))}else this.navigateToUrl(t,i,r)},v.prototype.redirectToSapphire=function(){if(typeof SAUpsellTrigger!="undefined")if(SAUpsellTrigger.setConfigs(this.config.sapphireSearchRedirectTimeout,this.config.maxSapphireSearchRedirect),SAUpsellTrigger.shouldRedirectToSapphire()){var n=this.getRedirectionPositionId();this.sapphireRedirectionLogger("SubmitFormHandler","RedirectToSapphire","PositionID",n);SAUpsellTrigger.queryNativelyByApp(this.searchForm,n,this.searchForm.submit.bind(this.searchForm))}else this.sapphireRedirectionLogger("SubmitFormHandler","RedirectionBlocked"),this.searchForm.submit();else this.sapphireRedirectionLogger("SubmitFormHandler","ScriptResourceNotLoaded"),this.searchForm.submit()},v.prototype.submitFormHandler=function(){this.config.enableSapphireSearchTrigger?this.config.blockIncognitoSapphireSearch&&this.config.isFirstSession?(this.sapphireRedirectionLogger("SubmitFormHandler","Incognito mode blocked"),this.searchForm.submit()):this.redirectToSapphire():this.searchForm.submit()},v.prototype.submitForm=function(n,i){var u,c,r,f,s,h,e;if(this.config.sbt){for(u=void 0;u=this._hiddenFields.shift();)u.parentNode==this.searchForm&&this.searchForm.removeChild(u);this._hiddenFields=[]}if(n&&(this.raiseEvent(15),this.config.bi&&this._currentImpressionQuery===this.searchBox.value)){sj_evt.fire(t);return}this._instrumentationData=this.autosuggest.getAllSuggestionInstObject(null,n,this.searchBox.value);c=this.getCustomUrlParams(i);r=_ge("sa_ghc");r&&r.parentNode.removeChild(r);for(var l=0,o=void 0,a=[this._instrumentationData,c];o=a[l++];)for(f in o)r=_ge("sa_"+f),s=o[f],r?r.value=s:this.addHiddenField(f,s);this.autosuggest.ghostInstValue=0;n||sj_evt.fire("onSearch",this.searchForm);this.makeSearchboxGPingCall();this.fireEvt?(h=this.searchForm.getAttribute("action"),i&&this.searchForm.setAttribute("action",i),this.submitFormHandler(),this.firePartnerEvents(n),h&&this.searchForm.setAttribute("action",h)):_w._H&&_w._H.ajax&&_w.sj_isAjax&&n||this.submitFormHandler();this.fireEvt&&(this.autosuggest.canvas.selectedSuggestion=null,this.autosuggest.ghostInstValue=0,e=_ge("sa_ghc"),!this._instrumentationData.ghc&&e&&e.parentNode.removeChild(e));this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&this.logAutoSuggestNetworkLatency()},v.prototype.makeSearchboxGPingCall=function(){var t=this.searchForm.getAttributeNode("onsubmit"),n;t&&_w.si_T&&(n=t.value.match(/si_T\('(.*)'\)/),n&&n[1]&&_w.si_T(n[1]))},v.prototype.isMsbSuggestion=function(n){return n=="Bookmark"||n=="Building"||n=="Person"||n=="Qna"||n=="Acronym"||n=="External"||n=="File"||n=="EducationAssignment"||n=="Group"||n=="UserHistory"||n=="External"},v.prototype.navigateToUrl=function(i,r,u){var o,s,h,c,l,a,v,y,p=((o=i.parentElement)===null||o===void 0?void 0:o.id)==e&&this.config.isLowConfidenceWeb,d=((s=i.parentElement)===null||s===void 0?void 0:s.getAttribute("data-region"))=="BAWC",f,w,b,k;if(i.stype==n.BingAtWorkDataTypes.Bookmarks)this.autosuggest.onBfbNavigateCallback(i.id,i.stype,p,i.query,i.getAttribute("logicalId"));else if(i.stype==n.BingAtWorkDataTypes.People)if(this.config.msbSusR)this.autosuggest.onSubstrateNavigateCallback(i.id);else this.autosuggest.onBfbNavigateCallback(i.id,i.stype,p,i.query,i.getAttribute("logicalId"));else if(this.isMsbSuggestion(i.stype))this.autosuggest.onBfbNavigateCallback(i.id,i.stype,p,i.query,i.getAttribute("logicalId"),i.url);if(d&&i.getAttribute("menu")==="webSerpMenu")this.autosuggest.onBfbSearchBoxAction("Search_Web_Qf_Click");if(this.searchForm.onsubmit)this.searchForm.onsubmit(null);if(this.firePartnerEvents(r),this.config.bi&&this._currentImpressionQuery===i.query){sj_evt.fire(t);return}f=i.url+(i.addInst?this.autosuggest.getAllSuggestionInstUrl():"");f=this.addExtraQueryStrings(f);i.nav&&!n.Utils.GetQueryStringParam(f,"form")&&(f=this.addFormCode(f));this.shouldRedirectToSapphire()?(w=this.getRedirectionPositionId(),this.sapphireRedirectionLogger("navigateToUrl","RedirectToSapphire","PositionID",w),SAUpsellTrigger.searchNativelyByApp(f,w,u)):u?_w.open(f,u):((c=(h=window.BingAtWork)===null||h===void 0?void 0:h.context)===null||c===void 0?void 0:c.isSharedSerpWorkBundlesEnabled)?(b="/work/search",k=f.substring(0,b.length)===b,k&&((a=(l=window.BingAtWork)===null||l===void 0?void 0:l.context)===null||a===void 0?void 0:a.isOnWorkVertical)&&((v=window.BingAtWork)===null||v===void 0?void 0:v.isMsbHandlingAutoSuggestRequery())?(y=window.BingAtWork)===null||y===void 0?void 0:y.handleAutoSuggestRequery(f):typeof sj_lc!="undefined"?sj_lc(f):_w.location.href=f):typeof sj_lc!="undefined"?sj_lc(f):_w.location.href=f},v.prototype.firePartnerEvents=function(n){!n&&this.fireEvt&&this.fireEvt(this.searchForm,"ASSugClicked")},v.prototype.getCustomUrlParams=function(n){var r={},t;if(n)for(var i=void 0,f=/\+/g,e=/([^&=]+)=?([^&]*)/g,u=function(n){return decodeURIComponent(n.replace(f," "))},o=n.substring(n.indexOf("?")+1);i=e.exec(o);)t=u(i[1]).toLowerCase(),t!=="q"&&t!=="form"&&(r[t]=u(i[2]));return r},v.prototype.bindEvents=function(n,t){var i=this,r;n(sj_b,"click",this.hideDropDownOnFocusChange);n(sj_b,"touchend",this.hideDropDownOnFocusChange);n(this.searchForm,"submit",this.onSubmit);this.config.submitOnEnter&&sj_evt.fire("AS.BindKeyDown");n(this.searchBox,"keydown",this.onSearchBoxKeyDown);this.config.CommonFooter&&n(this._asContainer,"keydown",this.onASKeyDown);this.config.enableSbLeftSpyglass&&this.addSearchBoxLeftSpyglass();"ontouchend"in _w&&n(this.searchBox,"touchend",this.searchBoxTouchAction);n(this.searchBox,"click",this.searchBoxClickAction);this.config.popUpASFromUA&&(this.config.clickUAClearSB?sj_evt.bind(f,this.clearSearchBox,!1):sj_evt.bind(f,this.searchBoxClickAction,!1));this.config.expandOnFocus&&n(this.searchBox,"focus",this.searchBoxClickAction);this.fireEvt&&n(_w,"blur",this.hideDropDownOnFocusChange);r=function(){t("focusChange",function(n){return i.focusChange(n)});t("hideDrawer",function(){return i.hideDropDown(3)});t("SB.LineChange",function(n){return i.handleAsDropDown(n)})};r();this.config.bi&&t("ajax.load",function(n){var t=n&&n[1];t&&t.isInstantRequest&&(i._currentImpressionQuery=t.query||i.searchBox.value,i.config.asdbc?i.debouncingAutosuggest():i.pollForQueryChange(),r())});"oninput"in this.searchBox&&n(this.searchBox,"input",this.onTextInput)},v.prototype.isJSONSuggestion=function(n){return n&&typeof n.q=="string"&&typeof n.t=="string"},v.prototype.fetchForCurrentQuery=function(){(this._noResultsTimeout&&sb_ct(this._noResultsTimeout),this._bDisabled)||(this._lastQuery=null,this.config.asdbc?this.fetchSuggestionsDebounced(this.getQueryToFetch(),this.getCurrentQuery(!0)):this.fetchSuggestions(this.getQueryToFetch(),this.getCurrentQuery(!0)))},v.prototype.showDropDown=function(){if(this._showAsdropdown){if(this._layout.update(),this.config.enableFullPageAs&&(_w.location.hash="asqf"),this.fireEvt){var n=this.autosuggest.canvas.containsNextWord?"1":"0";this.searchForm.setAttribute("SuggMode",n);this.fireEvt(this.searchForm,"autosuggestRendered")}this._isLayoutVisible||(sj_evt.fire("focusChange",this.searchBox),this._layout.show(),this._isLayoutVisible=!0,sb_i6&&sj_evt.fire("autosuggestShown",this.searchBox),sj_evt.fire("onPopTR"),this.fireEvt&&this.fireEvt(this.searchForm,"autosuggestShown"),this.searchForm.setAttribute("aria-owns","sw_as"))}else this._isLayoutVisible=!0,this.hideDropDown(5)},v.prototype.handleAsDropDown=function(n){if(this.config.ascontainer){var t=n&&n[1]?n[1].total_line:1;this.setshowAsDropDownValue(t<=1)}},v.prototype.hideDropDown=function(t,i){var r,u,o;if(t!=0&&(this._lastClickQuery=null),this._isLayoutVisible){if(this._layout.hide(),this._isLayoutVisible=!1,this.searchForm.removeAttribute("aria-owns"),r=n.Utils,u=document.getElementsByClassName("b_searchboxForm")[0],this.config.enableAsPanelExpansion){var f=/(\s|^)as_rsform/g,e=_ge("b_header");e&&r.RemoveClassName(e,f);r.RemoveClassName(u,f);this.autosuggest.canvas.isBNorrClassPresent&&r.AddClassName(document.body,"b_norr")}this.config.asshdw&&(o=/(\s|^)as_shadow/g,r.RemoveClassName(u,o));t!=0&&(this._lastQuery=this.getQueryToFetch());t!=5&&this.raiseEvent(30);this.raiseEvent(16);this.autosuggest.finalizeKeystroke();i&&this.config.hdm&&sj_pd(i);_w._H&&sj_evt.fire("ASHide");this.autosuggest.setQuery(undefined)}sj_evt.fire("autosuggestHide",this.searchBox,t);this.fireEvt&&(this.searchForm.removeAttribute("SuggMode"),this.fireEvt(this.searchForm,"autosuggestHide"))},v.prototype.focusChange=function(n){n[1]!==this.searchBox&&this.hideDropDown(1)},v.prototype.startNoMatchTimeout=function(){var n=this;this._noResultsTimeout=sb_st(function(){return n.hideDropDown(0)},50)},v.prototype.onUpdateText=function(n,t){t===void 0&&(t=!0);this.getCurrentQuery()!=n&&t&&(this._bRequeryOnTextChange=!1);t?this.updateSearchBoxValue(n):this.sendQfcEvent()},v.prototype.sendQfcEvent=function(n,t){this.config.ascontainer?(sj_evt.fire("AS.Input.Update",{suggestion:n,nudge:!0,type:"AS"}),this.config.easpm&&n!=null&&t!=null&&this.autosuggest.raiseGhostingEventFired(this.searchBox.value,t)):(!this.config.webMsbQFRanking||n)&&sj_evt.fire("AS.Input.Update",{target:this.searchBox})},v.prototype.updateSearchBoxValue=function(t,r,u){var f=r&&!this.config.ascontainer?t+r:t,e;this._autoCompletedPrefixLength=r&&!this.config.ascontainer?t.length:null;this.config.ghostingWithGreyText&&r&&(this._ghostingText=r,this._prefixText=this.config.ascontainer?t:t+r);f!==null&&(this.searchBox.value=f,i||(this.searchBox.setAttribute("value",f),this.sendQfcEvent(r,u)),e=f===null||f===void 0?void 0:f.length,e&&this.getCurrentQuery(!0)!=t&&n.Utils.SetSelectionRange(this.searchBox,e,e),this.config.asperfv2?t&&t!=this._lastTextChanged&&u===undefined&&this.triggerTextChangedEvent(t):t&&t!=this._lastTextChanged&&this.triggerTextChangedEvent(t))},v.prototype.onUpdateTextAndRequery=function(t,i){if(this._bRequeryOnTextChange=!0,this.updateSearchBoxValue(t),!i){var r=t.length;this.searchBox.focus();n.Utils.SetSelectionRange(this.searchBox,r,r)}},v.prototype.onUpdateGhostedText=function(n,t,i,r){this._bRequeryOnTextChange=i===undefined?!0:i;this.updateSearchBoxValue(n,t,r)},v.prototype.triggerTextChangedEvent=function(n){this._lastTextChanged=n;this.autosuggest.raiseTextChanged(n,++this._textChangeSequence)},v.prototype.getGhostingInformation=function(n){return n+this._ghostingText==this._prefixText?!0:!1},v.prototype.isQuerySubstringOfGhostedQuery=function(n){return this.config.ghostingWithGreyText&&(this.getGhostingInformation(n)||this._prefixText&&this._ghostingText&&this._lastQuery&&n.length>this._lastQuery.length&&this._prefixText.length>=n.length&&this._prefixText.indexOf(n)==0&&this._ghostingText.indexOf(this._prefixText.substring(n.length-1,this._prefixText.length-1))==0)?!0:!1},v.prototype.debouncingAutosuggest=function(){var e=this,t,n,r,f;this._bDisabled||(t=this.getCurrentQuery(!0),this._lastRawQuery!=t&&(this.autosuggest.setRawQuery(t),this._lastRawQuery=t,this.config.bi&&sj_evt.fire("AS.RawQueryChanged"),n=this.getQueryToFetch(),r=(this._lastQuery!=n||!this._bRequeryOnTextChange)&&!i,r=this.config.ascontainer?r:r&&!this.isQuerySubstringOfGhostedQuery(n),r&&(this.config.enableSbUpdate&&this.searchBox.setAttribute("value",n),this._isSearchBoxWebComponent&&this.config.enableSbUpdate&&(this.searchBox.value=t)),n!=this._lastQuery&&(this._bRequeryOnTextChange&&!this.suppressRequestForQuery?this.fetchSuggestionsDebounced(n,t):this.suppressRequestForQuery&&this.config.eNw&&this.autosuggest.canvas.resizeNextWord&&this._bRequeryOnTextChange?this.hideDropDown(4):this._bRequeryOnTextChange||(this._bRequeryOnTextChange=!0),this._lastQuery=n)),f=this._pollInterval,this._pollThrottlingEnabled&&(f*=1<<Math.max(0,this._pendingRequestCount-u+1)/2),sb_st(function(){return e.debouncingAutosuggest()},f))},v.prototype.pollForQueryChange=function(){var e=this,t,n,r,f;this._bDisabled||(t=this.getCurrentQuery(!0),this._lastRawQuery!=t&&(this.autosuggest.setRawQuery(t),this._lastRawQuery=t,this.config.bi&&sj_evt.fire("AS.RawQueryChanged"),n=this.getQueryToFetch(),r=(this._lastQuery!=n||!this._bRequeryOnTextChange)&&!i,r=this.config.ascontainer?r:r&&!this.isQuerySubstringOfGhostedQuery(n),r&&(this.config.enableSbUpdate&&this.searchBox.setAttribute("value",n),this._isSearchBoxWebComponent&&this.config.enableSbUpdate&&(this.searchBox.value=t)),n!=this._lastQuery&&(this._bRequeryOnTextChange&&!this.suppressRequestForQuery?this.fetchSuggestions(n,t):this.suppressRequestForQuery&&this.config.eNw&&this.autosuggest.canvas.resizeNextWord&&this._bRequeryOnTextChange?this.hideDropDown(4):this._bRequeryOnTextChange||(this._bRequeryOnTextChange=!0),this._lastQuery=n)),f=this._pollInterval,this._pollThrottlingEnabled&&(f*=1<<Math.max(0,this._pendingRequestCount-u+1)/2),sb_st(function(){return e.pollForQueryChange()},f))},v.prototype.fetchSuggestionsDebounced=function(n,t){var i=this;this.config.asdbcdly&&(this.debounceDelay=this.config.asdbcdly);this.debounceTimeout&&clearTimeout(this.debounceTimeout);this.debounceTimeout=setTimeout(function(){i.fetchSuggestions(n,t)},this.debounceDelay)},v.prototype.fetchSuggestions=function(n,t){this._noResultsTimeout&&sb_ct(this._noResultsTimeout);this.autosuggest.setCursorPosition(this.adjustCursorPositionForModifiedQuery(t,n));this.autosuggest.setQuery(n);n.length!=0||this.config.fetchOnEmpty||this.config.enableZeroQfWork||this.hideDropDown(0);this._pendingRequestCount++},v.prototype.adjustCursorPositionForModifiedQuery=function(n,t){var r=this.getCursorPosition(),i;if(t!==n&&t!="")for(i=0;i<n.length&&n[i]!=t[0];i++)r--;return r},v.prototype.handleResponseReceived=function(){this._pendingRequestCount--},v.prototype.getQueryToFetch=function(){var t=this.getCurrentQuery(!0).toLowerCase();return this.config.trimwsnr&&(t=n.Utils.TrimmedQueryFromSuggestions(this.autosuggest.canvas.currentSuggestionList,t)),t},v.prototype.isQueryGhosted=function(){var n;return this.config.ascontainer?!!((n=_qs(".ghost"))===null||n===void 0?void 0:n.innerText):!!this._autoCompletedPrefixLength},v.prototype.getCurrentQuery=function(n){var t,i,r="";return r=this._autoCompletedPrefixLength?(t=this.searchBox)===null||t===void 0?void 0:t.value.substr(0,this._autoCompletedPrefixLength):(i=this.searchBox)===null||i===void 0?void 0:i.value,n?r:r.replace(this._trimRegex,"").replace(this._removeSpacesRegex," ").toLowerCase()},v.prototype.getPartnerCode=function(n){var u="",i=n.indexOf("pc"),f,t,e,r;return i>=0&&(f=n.indexOf("&",i),r=f>=0?n.substr(i,f-i):n.substr(i),u+="&"+r),t=n.indexOf("pt"),t>=0&&(e=n.indexOf("&",t),r=e>=0?n.substr(t,e-t):n.substr(t),u+="&"+r),u},v.prototype.checkMonitr=function(n){var t=n.indexOf("form=monitr");return t>=0?"&"+n.substr(t,11):""},v.prototype.getPubcode=function(n){if(n.indexOf("pubcode=null")!==-1&&n.indexOf("pt=opentetris")!==-1)return"&pubcode=null";var t=n.indexOf("pubcode");return"&pubcode="+n.substr(t+8,32)},v.prototype.addExtraQueryStrings=function(n){return this.config.pv?n+this.getPubcode(document.URL)+"&pubexp=1&msbqf=false"+this.getPartnerCode(document.URL)+this.checkMonitr(document.URL):n},v.prototype.addFormCode=function(n){return n+"&form="+this.searchForm.form.defaultValue},v.prototype.getLastRequestedQuery=function(){return this._lastQuery},v.prototype.notifyDeleteHistory=function(n){this.raiseEvent(22,n)},v.prototype.dispose=function(){this.clearEvents();this.bindEvents(sj_ue,sj_evt.unbind);sb_ct(this._noResultsTimeout);this.internalEventTrigger&&this.internalEventTrigger.dispose()},v.prototype.isEmptyQuery=function(){var n=_ge("sb_form_q");return n&&!n.value},v.prototype.getContainer=function(){return _ge(this.config.c||"sw_as")},v.prototype.imeCheckForJapanese=function(){if(this.searchBox.blur(),this.searchBox.focus(),document.createEvent){var n=new Event("blurfocusIme");this.searchBox.dispatchEvent(n)}s=this.searchBox.value;setTimeout(function(){document.querySelector("#sb_form_q").value=s},50)},v.prototype.logAutoSuggestNetworkLatency=function(){_w.Log&&Log.Log&&Log.Log("Autosuggest","NetworkLatency","PerfInst",!1,"Meta",this.autosuggest.networkLatencyInfo)},v.prototype.gaNtp=function(n){return n!==null&&n.shadowRoot!==null?this.gaNtp(n.shadowRoot.activeElement):n},v.prototype.navigateJSON=function(n,t,i,r){var o=this,f,e,u;if(sb_st(function(){return o.hideDropDown(2)},5),this.makeAutoSuggestGPingCall(n),f=t,f!=undefined&&this.updateSearchBoxValue(f),this.config.logClickOnSuggestion&&(r?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","EnterClick",!1):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","MouseClick",!1)),this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&this.logAutoSuggestNetworkLatency(),this.shouldRedirectToSapphire()){e=this.getRedirectionPositionId();u=i+this.autosuggest.getAllSuggestionInstUrl();u=this.addExtraQueryStrings(u);this.sapphireRedirectionLogger("navigateToUrl","RedirectToSapphire","PositionID",e);SAUpsellTrigger.searchNativelyByApp(u,e);return}this.navigateToUrlJSON(t,i)},v.prototype.navigateToUrlJSON=function(n,i){if(this.searchForm.onsubmit)this.searchForm.onsubmit(null);if(this.config.bi&&this._currentImpressionQuery===n){sj_evt.fire(t);return}if(i){var r=i+this.autosuggest.getAllSuggestionInstUrl();r=this.addExtraQueryStrings(r);typeof sj_lc!="undefined"?sj_lc(r):_w.location.href=r}},v.prototype.updateLSOnClick=function(t){n.Utils.setItem(t,0)},v.prototype.clearQuery=function(){var n=_ge("sb_form_q");n&&(n.value="")},v.prototype.sapphireRedirectionLogger=function(n,t,i,r){i&&r?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest",n,t,!1,i,r):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest",n,t,!1)},v.prototype.getRedirectionPositionId=function(){return _w.location.pathname.indexOf("search")>0?"Bing_DirectOpen_SERP_AS":_w.location.pathname==="/"?"Bing_DirectOpen_HP_AS":"Bing_DirectOpen_OTHER_AS"},v.prototype.shouldRedirectToSapphire=function(){if(this.config.blockIncognitoSapphireSearch&&this.config.isFirstSession)return this.sapphireRedirectionLogger("shouldRedirectToSapphire","Incognito mode blocked"),!1;if(this.config.enableSapphireSearchTrigger&&typeof SAUpsellTrigger!="undefined"){if(SAUpsellTrigger.setConfigs(this.config.sapphireSearchRedirectTimeout,this.config.maxSapphireSearchRedirect),SAUpsellTrigger.shouldRedirectToSapphire())return!0;this.sapphireRedirectionLogger("SubmitFormHandler","RedirectionBlocked")}return!1},v.ScopeExtensions=[],v}(n.EventRegisterer);n.SearchForm=a})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));EventKeyCodes={Backsapce:"Backspace",Delete:"Delete"},function(n){var t;(function(n){var t=navigator.userAgent.toLowerCase(),i=t.indexOf("msie ")===-1||t.indexOf("rv:11.0")>-1,r=function(){function t(){this._imeInProgress=!1;this._rerankqfEnabled=!1;this._smoothGhostingSet=!1;this.compositionEventLogged=!1}return t.prototype.init=function(t){if(t.config.eHC){var i=new n.EventRegistration(this);i.add(6,this.onSearchFormInitialized);t.registerEvents(i)}this._instantEnabled=!!t.config.bi;this._rerankqfEnabled=t.config.webMsbQFRanking},t.prototype.onSearchFormInitialized=function(t){var r=this,o,u,e,h;this.searchFormInstance=t;u=t.autosuggest;u.ghostInstValue=0;this.isCursorPositionAtTheEnd=function(){return t.getCursorPosition()==r.searchFormInstance.getCurrentQuery(r.searchFormInstance.config.asdsg?!0:!1).length};var l=function(){return u.ghostInstValue=2},a=function(){u.ghostInstValue==0&&(u.ghostInstValue=1)},f=t.searchBox;this.isRtlMode=t.autosuggest.canvas.isRtl;this.getSearchBoxValue=function(){return f.value};this.getGhostedQuery=function(){var n;if((n=document.querySelector(".ghost"))!==null&&n!==void 0)return n.innerText};this.getCurrentImpressionQuery=t.getCurrentImpressionQuery;this.resetGhosting=function(n,t,i){var o,s,e;t?(s=(o=f===null||f===void 0?void 0:f.value)===null||o===void 0?void 0:o.length,e=r.getGhostedQuery(),u.raiseUpdateGhostedText(r.getSearchBoxValue()+e,null,n),l(),i&&u.raiseGhostingAccepted(s,e===null||e===void 0?void 0:e.length,i)):u.raiseUpdateGhostedText(r.getSearchBoxValue(),null,n)};this.removeGhosting=function(n){n?u.raiseUpdateTextAndRequery(r.getSearchBoxValue()):u.raiseUpdateText(r.getSearchBoxValue())};this.setGhostValue=function(n,t,i){t?(u.raiseUpdateGhostedText(n,t,!0,i),a(),u.raiseGhostedTextLength(n.length,t.length)):u.raiseUpdateTextAndRequery(n)};this.updateQfcContainer=function(n){n===void 0&&(n=!0);r.searchFormInstance.config.enableAlwaysUpdateQFC&&u.raiseUpdateText(r.getSearchBoxValue(),n)};var v=function(n){return r.handleSearchBoxKeyPress(n)},y=function(n){return r.handleSearchBoxKeyDown(n)},p=function(){return sb_st(function(){return r.handlePasteEvent()},0)},w=function(){return r.handleSearchBoxMouseDown()},b=function(){return r.removeGhosting(!1)},k=function(){return r.handleCompositionStart()},d=function(){return r.handleCompositionEnd()},g=function(n){return r.handleSearchBoxKeyUp(n)},c=function(n,t){n(f,"keypress",v);n(f,"keydown",y);n(f,"mousedown",w);n(f,"paste",p);t("onFeedbackStarting",b);i?(n(f,"compositionstart",k),n(f,"compositionend",d)):n(f,"keyup",g)},s=new n.EventRegistration(this);s.add(10,this.handleSuggestionsRendered);s.add(17,function(){return c(sj_ue,sj_evt.unbind)});u.registerEvents(s);e=new n.EventRegistration(this);e.add(15,function(){r.getGhostedQuery()&&r.resetGhosting(!1,!1)});e.add(30,this.onDropDownHidden);t.registerEvents(e);t.config.ascsr&&(h=new n.EventRegistration(this),h.add(10,this.handleSuggestionsRendered),(o=t.internalEventTrigger)===null||o===void 0?void 0:o.registerEvents(h));c(sj_be,sj_evt.bind)},t.prototype.onDropDownHidden=function(){var n=this.getGhostedQuery();n&&(this._instantEnabled?this.getCurrentImpressionQuery()===n&&this.resetGhosting(!1,!0):this.removeGhosting(!1))},t.prototype.handleCompositionStart=function(){this._imeInProgress=!0;this.compositionEventLogged||(this.compositionEventLogged=!0,Log.Log("SystemEvent","AS","CompositionEvent",!1));this.isCursorPositionAtTheEnd()&&this.removeGhosting(!1)},t.prototype.handleCompositionEnd=function(){this._imeInProgress&&(this._imeInProgress=!1,this.isCursorPositionAtTheEnd()&&(this.resetGhosting(!0,!1),this._pendingGhostFirstSuggestion&&sb_st(this._pendingGhostFirstSuggestion,0)))},t.prototype.ghostFirstSuggestion=function(n,t,i,r){var f,u,e,o;if(this._pendingGhostFirstSuggestion!==null&&(n=this.getSearchBoxValue()),this._pendingGhostFirstSuggestion=null,!n||t!=n.toLowerCase()){this.updateQfcContainer(!1);return}if(this._lastKeyDown==EventKeyCodes.Backsapce||this._lastKeyDown==EventKeyCodes.Delete){this.updateQfcContainer(!1);return}i&&(this.searchFormInstance.config.ascsr&&this.searchFormInstance.config.enableCSRForBAW&&(e=i,i=e.filter(function(n){return n.id.startsWith("sa")})),u=i?i[0]:null);this.searchFormInstance.config.ascsr&&u?(u=u,u&&u.g&&(f=u.g)):u&&!this.searchFormInstance.config.ascsr&&u.ghtxt&&(f=u.ghtxt);f&&f.indexOf(t)==0&&f.length>n.length?(o=f.slice(n.length),this.setGhostValue(n,o,r)):this.updateQfcContainer(!1)},t.prototype.handleSuggestionsRendered=function(t,i,r,u,f,e){var v=this,s,h,o,c,l,a;if((!this.searchFormInstance.config.ghostingWithGreyText||!this.searchFormInstance.getGhostingInformation(t))&&!this._smoothGhostingSet){if(!this.isCursorPositionAtTheEnd()){this.updateQfcContainer(!1);return}o=(h=(s=u===null||u===void 0?void 0:u.children)===null||s===void 0?void 0:s.namedItem("sa_ul"))===null||h===void 0?void 0:h.children;(o===null||o===void 0?void 0:o.length)>0&&(c=this.searchFormInstance.config.ghostingThreshold?o[0].id==="bawh"||o[0].id==="bawuh"?o[0]:null:o[0].id==="bawh"?o[0]:null);this._rerankqfEnabled&&f==n.DataSources.MicrosoftSearchInBingCached&&(c||this.searchFormInstance.config.ascsr&&this.searchFormInstance.config.enableCSRForBAW)&&(this.getGhostedQuery()&&this.removeGhosting(!0),(c.childNodes.length>=1||this.searchFormInstance.config.ascsr&&this.searchFormInstance.config.enableCSRForBAW)&&(l=this.getSearchBoxValue(),this._imeInProgress?this._pendingGhostFirstSuggestion=function(){return v.ghostFirstSuggestion(l,t,i,r)}:e||this.ghostFirstSuggestion(l,t,i,r)));f==n.DataSources.Web&&(a=this.getSearchBoxValue(),this._imeInProgress?this._pendingGhostFirstSuggestion=function(){return v.ghostFirstSuggestion(a,t,i,r)}:e||this.ghostFirstSuggestion(a,t,i,r))}},t.prototype.handlePasteEvent=function(){this.getGhostedQuery()||this.updateQfcContainer(!1)},t.prototype.handleSearchBoxKeyDown=function(n){var r=this,t,u;if(this._lastKeyDown=n.code,t=n.keyCode,n.ctrlKey&&t==90){sj_pd(n);return}if(i||this._imeInProgress||t!=229||this.handleCompositionStart(),(this._lastKeyDown==EventKeyCodes.Backsapce||this._lastKeyDown==EventKeyCodes.Delete)&&(this._smoothGhostingSet=!1),!this._imeInProgress&&this.getGhostedQuery()){if(this.getGhostedQuery()&&(t==38||t==40)){this.removeGhosting(!1);return}switch(t){case n.shiftKey&&13:this.resetGhosting(!0,!1);break;case 13:this.resetGhosting(!1,!1);break;case 33:case 34:break;case 37:this.isRtlMode?this.resetGhosting(!0,!0,"arrowLeft"):this.resetGhosting(!0,!1);break;case n.shiftKey&&39:this.isRtlMode?this.resetGhosting(!0,!1):this.resetGhosting(!1,!0,"shiftArrowRight");break;case 35:this.resetGhosting(!0,!0,"pressEnd");break;case 39:this.isRtlMode?this.resetGhosting(!0,!1):this.resetGhosting(!0,!0,"arrowRight");break;case n.shiftKey&&37:this.isRtlMode?this.resetGhosting(!0,!0,"shiftArrowLeft"):this.resetGhosting(!0,!1);break;case n.ctrlKey&&65:this.resetGhosting(!0,!1);break;case 9:this.resetGhosting(!0,!0,"pressTab");sj_pd(n);sj_sp(n);break;case 27:case n.ctrlKey&&8:this.removeGhosting(!0);sj_pd(n);break;case 46:case 8:case n.ctrlKey&&88:this.resetGhosting(!0,!1);break;case n.ctrlKey&&86:case n.shiftKey&&45:this.removeGhosting(!0);break;default:u=this.getSearchBoxValue().toLowerCase();sb_st(function(){u==r.getSearchBoxValue().toLowerCase()||r._smoothGhostingSet||r.resetGhosting(!0,!1)},0)}}},t.prototype.handleSearchBoxKeyUp=function(n){var t=n.keyCode;this._imeInProgress&&(t==13||t==27||t==8||t==37||t==39)&&this.handleCompositionEnd()},t.prototype.handleSearchBoxKeyPress=function(n){var t=this.getGhostedQuery();if(t){var i=n.char?n.char:String.fromCharCode(n.charCode?n.charCode:n.keyCode),f=this.getSearchBoxValue(),r=t,u=r.slice(1);r.charAt(0)==i.toLowerCase()&&u?(this._smoothGhostingSet=!0,this.setGhostValue(f+i,u),sj_pd(n)):(this._smoothGhostingSet=!1,this.resetGhosting(!0,!1))}else this._smoothGhostingSet=!1},t.prototype.handleSearchBoxMouseDown=function(){this.getGhostedQuery()&&this.resetGhosting(!0,!0,"pressTap")},t}();n.SearchForm.ScopeExtensions.push(new r)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function t(){this.nwAsFullSuggestionsEnabled=!1}return t.prototype.init=function(t){var o=this,f=t.autosuggest,r=new n.EventRegistration(this),u,e,i;r.add(6,function(){o.ini(f.canvas.container)});r.add(16,this.hide);r.add(22,this.hide);t.registerEvents(r);u=new n.EventRegistration(this);u.add(11,this.hide);u.add(24,this.hide);f.canvas.registerEvents(u);e=new n.EventRegistration(this);e.add(10,this.show);f.registerEvents(e);t.internalEventTrigger&&(i=new n.EventRegistration(this),i.add(10,this.show),i.add(35,this.showEase),i.add(11,this.hide),t.internalEventTrigger.registerEvents(i));this.nwAsFullSuggestionsEnabled=t.config.nextWordNFullSuggsOne},t.prototype.ini=function(n){this._ct=n},t.prototype.show=function(n,t,i){var u=this,f=this.hasNw(t)&&!this.nwAsFullSuggestionsEnabled,r;if(!this._fdb){if(f)return;this._fdb=sj_ce("button","sb_fdb","sa_fd");this._fdb.innerText=sa_loc.Feedback;this._fdb.tabIndex=0;this._ct.parentElement.appendChild(this._fdb);r="undefined";typeof Feedback!==r&&typeof Feedback.Bootstrap!==r&&Feedback.Bootstrap.InitializeFeedback({page:!0},this._fdb.id,!0,!1,!1,!1,!1,{formConfig:"Autosuggest_Web",service:"AutoSuggest",scenario:"Web"});sj_evt.bind("ajax.feedback.collectsettings",function(n){var t={};t.fb_suggestions=JSON.stringify(u.fb_suggestions||[]);n[1].setStartSettings(u._fdb,{formConfig:"Autosuggest_Web",service:"AutoSuggest",scenario:"Web",context:t})})}if(i!==this.lastRequestSequence&&(this.lastRequestSequence=i,this.fb_suggestions=[]),this.populateFeedbacksuggestions(t),f){this.hide();return}this.updateLayout(0)},t.prototype.showEase=function(n){this.fb_suggestions=[];this.populateFeedbacksuggestions(n)},t.prototype.populateFeedbacksuggestions=function(n){for(var r,t=(r=this.fb_suggestions)===null||r===void 0?void 0:r.reduce(function(n,t){return n[t.text]=t.stype,n},{}),u=0,e=n;u<e.length;u++){var i=e[u],f=sa_config.ascsr?i.q:i.query,o=(sa_config.ascsr?i.t:i.stype)||"BAW";f in t?t[f]+="||"+o:t[f]=o}this.fb_suggestions=Object.keys(t).map(function(n){return{text:n,stype:t[n]}})},t.prototype.hide=function(){this._fdb&&(this._fdb.style.display="none")},t.prototype.updateLayout=function(n){var t=this;sb_st(function(){t._ct.style.display!="none"&&(t._fdb.style.top=t._ct.offsetHeight-n+"px",t._fdb.style.display="block")},20)},t.prototype.hasNw=function(n){return this.hasSuggestionOfType(n,"NW")},t.prototype.hasSuggestionOfType=function(n,t){for(var r,i=0;i<n.length;i++)if(r=sa_config.ascsr?n[i].t:n[i].stype,r&&r.indexOf&&r.indexOf(t)>-1)return!0;return!1},t}();n.SearchForm.ScopeExtensions.push(new t)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function t(){}return t.prototype.getCallbacks=function(){var t=new n.EventRegistration(this);return t.add(11,this.onNoResults),t.add(10,this.onSuggestionsRendered),t},t.prototype.set=function(n){this._data=n;this._data.currentQuery.length<=1&&(this._lastQueryWithNoResults=null)},t.prototype.match=function(){return this._lastQueryWithNoResults&&this._data.currentQuery.substr(0,this._lastQueryWithNoResults.length)==this._lastQueryWithNoResults},t.prototype.onNoResults=function(n){this._lastQueryWithNoResults=n},t.prototype.onSuggestionsRendered=function(t,i,r,u,f){f==n.DataSources.Web&&(this._lastQueryWithNoResults=null)},t}(),r=function(){function t(n){this._searchFormInstance=n;this._exceededNextWordLimit=!1}return t.prototype.getCallbacks=function(){return new n.EventRegistration(this)},t.prototype.set=function(){if(this._searchFormInstance.config.ascqsl!=2e3){var t=this._searchFormInstance.getCurrentQuery(),i=this._searchFormInstance.searchBox.offsetWidth,r=this._searchFormInstance.searchForm?n.Utils.CalcWidth(this._searchFormInstance.searchForm,t):0,u=r/i;this._exceededNextWordLimit=u>.7}},t.prototype.match=function(){return this._exceededNextWordLimit},t}(),u=function(){function t(n){this._searchFormInstance=n;this._supressQueryCall=!1}return t.prototype.getCallbacks=function(){return new n.EventRegistration(this)},t.prototype.set=function(){this._supressQueryCall=this._searchFormInstance.getCurrentQuery().length>this._searchFormInstance.getCursorPosition()?!1:!0},t.prototype.match=function(){return this._supressQueryCall},t}(),t=function(){function t(){this._rules=[]}return t.prototype.init=function(t){var i=new n.EventRegistration(this);i.add(6,this.onSearchFormInitialized);t.registerEvents(i)},t.prototype.onSearchFormInitialized=function(n){this._searchFormInstance=n;this.addRules();this.addCallbacks()},t.prototype.addRules=function(){var n=this._searchFormInstance.config;n.eNw&&n.nwLim&&this._rules.push(new r(this._searchFormInstance));n.suppnores&&this._rules.push(new i(n));!n.ascontainer||n.isMobile||n.iscxtab||this._rules.push(new u(this._searchFormInstance))},t.prototype.addCallbacks=function(){var o=this._rules.length,r,u,t,f,e,i;if(o)for(r=this._searchFormInstance.autosuggest,u=new n.EventRegistration(this),u.add(18,this.onTextChanged),r.registerEvents(u),t=0,f=this._rules;t<f.length;t++)e=f[t],i=e.getCallbacks(),i&&(r.registerEvents(i),this._searchFormInstance.internalEventTrigger&&this._searchFormInstance.internalEventTrigger.registerEvents(i))},t.prototype.updateDataForRules=function(){var n,t,i;for(this._data={currentQuery:this._searchFormInstance.getCurrentQuery()},n=0,t=this._rules;n<t.length;n++)i=t[n],i.set(this._data)},t.prototype.getSuppressRequestForQuery=function(){var n,t,i;if(this._data.currentQuery.length>this._searchFormInstance.config.ascqsl)return 1;if(!this._searchFormInstance.config.noNextWordTermination&&this._data.currentQuery.length>1)for(n=0,t=this._rules;n<t.length;n++)if(i=t[n],i.match())return 1;return 0},t.prototype.onTextChanged=function(){this.updateDataForRules();this._searchFormInstance.suppressRequestForQuery=this.getSuppressRequestForQuery()},t}();n.PrefixThrottling=t;n.SearchForm.ScopeExtensions.push(new t)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function i(){}return i.prototype.init=function(t){if(t.config.removeSuggUrl){var i=new n.EventRegistration(this);i.add(6,this.internalInit);t.registerEvents(i)}},i.prototype.internalInit=function(n){var i=this;return this.searchForm=n,new t(n.autosuggest,function(n){return i.getUrl(n)},function(n,t){return i.handleResult(n,t)})},i.prototype.getUrl=function(n){return this.searchForm.config.removeSuggUrl.replace("%7b0%7d",encodeURIComponent(n.q))},i.prototype.handleResult=function(n){var t=JSON.parse(n);t.success&&this.searchForm.notifyDeleteHistory(0)},i}(),t;n.SearchForm.ScopeExtensions.push(new i);t=function(){function t(t,i,r){var f=this,u;this._autosuggest=t;this._getUrl=i;this._handleResponse=r;this._autosuggest.internalEventTrigger&&(u=new n.EventRegistration(this),u.add(32,function(n){f.process(n)}),this._autosuggest.internalEventTrigger.registerEvents(u))}return t.prototype.process=function(n){var i=this._getUrl(n),t;return i?(this.sendRequest(i,n),typeof Log!="undefined"&&typeof Log.Log!="undefined"&&(t=this.getGpingData(n),Log.Log("Request","Delete","Click",!1,"ImpressionGuid",this._autosuggest.data.Inst.IG,"AppNS",t.appNs,"K",t.k)),!0):!1},t.prototype.sendRequest=function(n,t){var r=this,i=sj_gx();i.open("GET",n,!0);i.onreadystatechange=function(){i.readyState==4&&i.status==200&&r._handleResponse(i.responseText,t)};i.withCredentials!==undefined&&(i.withCredentials=!0);i.send()},t.prototype.getGpingData=function(n){var i=_ge(n.id).getAttribute("h"),t;if(!i)throw new Error("Missing 'h' attribute on suggestion element.");if(t=i.replace("ID=","").split(","),t.length!=2)throw new Error("Invalid 'h' attribute on suggestion element.");return{appNs:t[0],k:t[1]}},t}()})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){function t(n){var t=document.createElement("div");return t.textContent=n,t.innerHTML.replace(/"/g,"&quot;")}var i=function(){function n(){}return n.prototype.init=function(n){this._callback=n},n.prototype.fetch=function(n,i,r,u,f){var c,o,h,v;if((sa_config.ascbbottom||sa_config.ascbtop||sa_config.ascbiq||sa_config.ascbnw)&&(o=(c=t(u))===null||c===void 0?void 0:c.toLowerCase(),o&&o.length&&o.trim())){var y=sa_config.aschaturl?"/chat":"/search",e=sa_loc.ASQFChatBannerText||'Try Copilot for "{0}"',p=e.replace('"{0}"',o)+" "+sa_loc.NudgesAStoChatClickthrough,s='<div class="textinput" style = "white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">',l=encodeURI("".concat(y,"?q=").concat(o,"&qs=SYC&showconv=1&sendquery=1&FORM=ASCHT2")),a="class='bordertop'",w=sa_loc.ASQFChatBannerCTAText||"Chat";r&&(a="class='borderbottom'");h='\n                <div id=\'chatButton\' class=\'chatButton\' role=\'Button\'\'>\n                    <svg width="16" height="16" viewBox="0 0 16 16"  xmlns="http://www.w3.org/2000/svg">\n                        <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7H5.5C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6H10.5Z" fill="white"><\/path>\n                    <\/svg>\n                    <div id=\'chatText\' class=\'chatText\'>'.concat(w,"<\/div>\n                <\/div>");n?(h="",i?(e=sa_loc.SydneyUpsellChatText||"Hi, I am Bing. Your AI powered copilot for web. ",s='<div class="textinputstatic" style = "white-space: normal;">',e=s.concat(e.concat('<span class="sydneyUpsellChatText">Get Started<\/span><\/div>'.toString()))):(e=s.concat(e.concat("<\/div>")),e=e.replace("{0}",o))):i?(e=sa_loc.SydneyUpsellChatText||"Hi, I am Bing. Your AI powered copilot for the web. ",e=s.concat(e.concat('<span class="sydneyUpsellChatText">Get Started<\/span><\/div>'.toString())),h=""):(e=s.concat(e.concat("<\/div>")),e=e.replace("{0}",o));v='\n          <li role="option" h="ID=autosuggest,9999.1" url='.concat(l,' query="').concat(o,'" id="assyc" stype="SYC" aria-label="').concat(p,'" display="inline-block" a href="').concat(l,'" position:"absolute" ').concat(a,' ">\n            <div class="codexchat" >\n                <img class="light-mode" height="30" width="30" src="https://www.bing.com/rp/em88jYr3ZOv7yX3AqoOU5z8EEnA.png" role="presentation" data-bm="77" />\n                <img class="dark-mode" width="30" height="30" src="https://www.bing.com/rp/em88jYr3ZOv7yX3AqoOU5z8EEnA.png" role="presentation" data-bm="77" />\n             <\/div>\n            ').concat(e,"\n            ").concat(h,"\n          <\/a>\n        <\/li>");this._callback(v.trim(),u,f)}},n.prototype.fetchZeroQF=function(){},n}();n.SydneyDataProvider=i})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(t){function i(){var i=t.call(this)||this;return i.fireSuggestionsRenderedEvents=function(t){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4];i.raiseEvent(10,u,f,e,i._container,n.DataSources.Web,o)},i.fireFeedbackRenderedEvents=function(n){var t=n[0],r=n[1];i.raiseEvent(35,r)},i.fireNoSuggestionRenderedEvents=function(n){var t=n[0],r=n[1];i.raiseEvent(11,r)},i.fireSuggestionOnClickEvents=function(n){var u=n[0],t=n[1],r=n[2];t=t;r&&i.raiseEvent(12,r);i.raiseEvent(19,t,!0);sj_evt.fire("AS.Navigate",t,"mouseup");i.raiseEvent(4,t.id,r,t.u)},i.fireSuggestionOnHoverEvents=function(n){var t=n[0],r=n[1],u=n[2];i.raiseEvent(12,u);i.raiseEvent(19,r)},i.fireOnRemoveButtonClickedEvents=function(n){var t=n[0],r=n[1];i.raiseEvent(32,r)},i.fireOnQueryBuilderClickedEvents=function(n){var t=n[0],r=n[1];i.raiseEvent(33,r)},i.init(),i}return __extends(i,t),i.prototype.init=function(){this._container=document.querySelector(".sa_as");this.registerCSREvents()},i.prototype.dispose=function(){this.clearEvents();this.unRegisterCSREvents()},i.prototype.registerCSREvents=function(){sj_evt.bind("AS.CsrSuggestionsRendered",this.fireSuggestionsRenderedEvents);sj_evt.bind("AS.CsrNoSuggestionRendered",this.fireNoSuggestionRenderedEvents);sj_evt.bind("AS.CsrSuggestionOnClick",this.fireSuggestionOnClickEvents);sj_evt.bind("AS.CsrSuggestionOnHover",this.fireSuggestionOnHoverEvents);sj_evt.bind("AS.CsrSuggestionOnRemoveButtonClick",this.fireOnRemoveButtonClickedEvents);sj_evt.bind("AS.CsrSuggestionOnQueryBuilderClick",this.fireOnQueryBuilderClickedEvents);sj_evt.bind("AS.CsrFeedbackRendered",this.fireFeedbackRenderedEvents)},i.prototype.unRegisterCSREvents=function(){sj_evt.unbind("AS.CsrSuggestionsRendered",this.fireSuggestionsRenderedEvents);sj_evt.unbind("AS.CsrNoSuggestionRendered",this.fireNoSuggestionRenderedEvents);sj_evt.unbind("AS.CsrSuggestionOnClick",this.fireSuggestionOnClickEvents);sj_evt.unbind("AS.CsrSuggestionOnHover",this.fireSuggestionOnHoverEvents);sj_evt.unbind("AS.CsrSuggestionOnRemoveButtonClick",this.fireOnRemoveButtonClickedEvents);sj_evt.unbind("AS.CsrSuggestionOnQueryBuilderClick",this.fireOnQueryBuilderClickedEvents);sj_evt.unbind("AS.CsrFeedbackRendered",this.fireFeedbackRenderedEvents)},i}(n.EventRegisterer);n.InternalEventTrigger=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(){var n=sa_config,f,e,o,s,h,c,l,a,v,r,i,u,y,t,w,b;if(!n.asBundleLoaded){for(n.asBundleLoaded=!0,n.aslogtel&&n.asBundleLoaded&&Log.Log("ASBundleLoad","AS","AutoSuggestBootstrap",!1),performance.mark("AutosuggestJSBundleLoaded"),f=Bing.AS.SydneyDataProvider&&new Bing.AS.SydneyDataProvider||null,e=Bing.AS.CommonPrefixDataProvider?new Bing.AS.CommonPrefixDataProvider:new Bing.AS.DataProvider,u=0,y=n.enabledDataSources;u<y.length;u++)t=y[u],(t===Bing.AS.DataSources.BingAtWork||t===Bing.AS.DataSources.Substrate||t===Bing.AS.DataSources.MicrosoftSearchInBing)&&(i||(i=AutoSuggest.BingAtWorkWebTelemetry?new AutoSuggest.BingAtWorkWebTelemetry(n,"AS"):null),r||(r=Bing.AS.MSBWebClientInstrumentation?new Bing.AS.MSBWebClientInstrumentation:Bing.AS.WebClientInstrumentation?new Bing.AS.WebClientInstrumentation:null)),t===Bing.AS.DataSources.BingAtWork?(o=Bing.AS.CachingDataProvider?new Bing.AS.CachingDataProvider(t):Bing.AS.BingAtWorkDataProvider?new Bing.AS.BingAtWorkDataProvider:null,l=Bing.AS.BingAtWorkSuggestionsParserV3?new Bing.AS.BingAtWorkSuggestionsParserV3(n):null):t===Bing.AS.DataSources.Substrate?(s=Bing.AS.SubstrateDataProvider?new Bing.AS.SubstrateDataProvider(i):null,a=Bing.AS.SubstrateSuggestionsParser?new Bing.AS.SubstrateSuggestionsParser(n):null):t===Bing.AS.DataSources.MicrosoftSearchInBing?(h=Bing.AS.MsbDataProvider?new Bing.AS.MsbDataProvider:null,v=Bing.AS.MsbSuggestionsParser?new Bing.AS.MsbSuggestionsParser(n):null):t===Bing.AS.DataSources.MSBEngagment&&(c=Bing.AS.MSBEngagementDataProvider?new Bing.AS.MSBEngagementDataProvider:null);if(n.ascsr){var p=new Bing.AS.InternalEventTrigger,w=new Bing.AS.CsrClientState(p),b=new Bing.AS.WebCore(w,e,o,s,h,c,r,l,a,v,i,f,p);sa_inst=new Bing.AS.SearchForm(n,b,p)}else Bing.AS.Canvas!==null&&typeof Bing.AS.Canvas!="undefined"&&(w=new Bing.AS.Canvas,b=new Bing.AS.WebCore(w,e,o,s,h,c,r,l,a,v,i,f),sa_inst=new Bing.AS.SearchForm(n,b));sa_inst!==null&&sa_inst!==undefined&&(sa_inst.init("sa_inst"),sa_eL&&sa_inst.show());_w.sj_evt&&sj_evt.fire("autoSugLoaded");sj_evt.bind("ajax.load",function(n){var t=n&&n[1];t&&t.isInstantRequest&&_w.sj_evt&&sj_evt.fire("autoSugLoaded")})}}()