var MobileIcon;(function(){function hr(){st()?(it("Overlap"),s("Overlap")):ti("ResizeShow")}function st(){return(et===null||et===void 0?void 0:et.offsetWidth)-((ut===null||ut===void 0?void 0:ut.offsetWidth)+(ft===null||ft===void 0?void 0:ft.offsetWidth)+pt)<li}function o(){c("ClickPage");s("ClickPage")}function gt(t){t.key==="Escape"&&(p||tt)&&(n&&n.focus(),c("EscapeKeydown"),s("EscapeKeydown"))}function cr(){var n;(n=_w.localStorage)===null||n===void 0?void 0:n.setItem(pi,"true")}function ni(n){Log.Log("Click","MobileIconV2","GetApp");Log.Log(r,t,"ClickPanel");n.stopPropagation();_w.open(u,"blank")}function ti(i){n&&bt&&(Lib.CssClass.remove(n,"b_hide"),Log.Log(r,t,hi,!1,"reason",i))}function it(i){n&&Lib.CssClass.add(n,"b_hide");Log.Log(r,t,"HideIcon",!1,"reason",i)}function ht(i){if(!kt){lr(!1);return}if(Log.Log(r,t,"ShowPanel",!1,"reason",i),!dt&&_w.QRCode&&u.length){var f=_qs("#id_mobqrimg");f&&(new _w.QRCode(f,{text:u,width:84,height:84,correctLevel:1}),dt=!0)}fi();gr();n&&Lib.CssClass.add(n,"active");p=!0}function c(i){p&&(Log.Log(r,t,"HideFlyout",!1,"reason",i),ei(),n&&Lib.CssClass.remove(n,"active"),p=!1)}function s(n){if(tt){var i=_qs("#id_mobbubpos");if(i){Log.Log(r,t,"HideBubble",!1,"reason",n);ei();Lib.CssClass.add(i,"b_hide");tt=!1;return}}}function lr(t){var r,u,i;sj_gx&&v.length&&(r=void 0,u=t?"1":"0",r="".concat(v,"&installuser=").concat(u),i=sj_gx(),i.onreadystatechange=function(){i.readyState==4&&i.status==200&&(kt=!0,n.insertAdjacentHTML("afterend",i.responseText),sb_st(function(){ht("fetchContent")},200))},i.open("GET",r,!0),i.send())}function ar(n){if(g&&g.length){n(g);return}if(!sj_gx){n(null);return}var t=sj_gx();t.onreadystatechange=function(){if(t.readyState==4)if(t.status==200)try{var i=JSON.parse(t.responseText);g=i.token;n(i.token)}catch(r){n(null)}else n(null)};t.onerror=function(){n(null)};t.open("GET",wi,!0);t.send()}function vr(n,i){var f,e,u;if(!n||!n.length||!sj_gx){i(!1);Log.Log(r,t,"CheckInstall",!1,"stage","TokenMissing");return}if(f=sj_cook.get("ANON","A"),!f||!f.length){i(!1);Log.Log(r,t,"CheckInstall",!1,"stage","AnidMissing");return}e="https://notification.api.microsoftapp.net/user/injection/v1/".concat(f);u=sj_gx();u.onreadystatechange=function(){if(u.readyState==4)try{var f=JSON.parse(u.responseText),n=!!f.exists;i(n);Log.Log(r,t,"CheckInstallResult",!1,"status",""+u.status,"exists",""+n)}catch(e){i(!1);Log.Log(r,t,"CheckInstallResult",!1,"status",""+u.status)}};u.onerror=function(){i(!1);Log.Log(r,t,"CheckInstallResult",!1,"status","Error")};u.open("GET",e,!0);u.setRequestHeader("Authorization","Bearer ".concat(n));u.send();Log.Log(r,t,"CheckInstall",!1,"stage","Request")}function yr(){var u,i,f;_mobIconV2Config.EnableBub&&!nt&&sj_gx&&d>0&&!_ge(at)?(u="/header/mobupsellbub?customtype=".concat(d),i=sj_gx(),i.onreadystatechange=function(){var u;nt||i.readyState!=4||i.status!=200||_ge(at)||(n.insertAdjacentHTML("beforeend",i.responseText),_mobIconV2Config.IsHomepage&&((u=_qs("#id_mobbubpos"))===null||u===void 0?void 0:u.style.setProperty("--mob-icon-v2-arrow-right","88px")),tt=!0,ri("".concat(wt).concat(d)),Log.Log(r,t,"ShowBubble"),fi())},i.open("GET",u,!0),i.send()):(f=ii(ui("".concat(lt)),yi),f&&(a==null&&(a=sj_ce("div","mob_dot","b_hide"),n===null||n===void 0?void 0:n.appendChild(a)),_mobIconV2Config.AnimRes&&!ot&&e&&sb_st(function(){var t,i;e.style.setProperty("content",'url("'.concat(_mobIconV2Config.AnimRes,'")'));e.style.setProperty("margin-left","2px");e.style.setProperty("height","42px");(t=n===null||n===void 0?void 0:n.style)===null||t===void 0?void 0:t.setProperty("top","3px");(i=l===null||l===void 0?void 0:l.style)===null||i===void 0?void 0:i.setProperty("bottom","14px");ot=!0},50),sb_st(function(){Lib.CssClass.remove(a,"b_hide")},550)))}function pr(n){return n<=0?Number.MAX_VALUE:Math.floor((Date.now()-n)/864e5)}function ii(n,t){return n<=0||pr(n)>t}function ri(n){var t;(t=_w.localStorage)===null||t===void 0?void 0:t.setItem(n,""+Date.now())}function ct(n){var i,r,t;try{return y==null&&(r=_w.location.href,t=r.split("?"),t&&t.length>1&&(y=new URLSearchParams(t[1]))),(i=y===null||y===void 0?void 0:y.get(n))===null||i===void 0?void 0:i.trim()}catch(u){return null}}function wr(){var n,t=(n=ct("form"))===null||n===void 0?void 0:n.toLowerCase(),i=ct("q");return(t=="sp0001"||t=="sp0002")&&i=="夏天去哪玩"}function br(){if(_mobIconV2Config.Type==40){wr()?(v="header/mobupsellfly?customtype=".concat(_mobIconV2Config.Type),u=h(ur,!1,!0),ht("AutoCNSpotlight")):(v="header/mobupsellflycn?",u=h(fr,!1,!0));return}var n=0;switch(_mobIconV2Config.Type){case 10:u=h(_mobIconV2Config.EnableBub?di:gi,!0);n=_mobIconV2Config.HasRewardsHeader?31:30;break;case 20:u=h(_mobIconV2Config.EnableBub?nr:tr);n=_mobIconV2Config.HasRewardsHeader?31:30;break;case 30:u=h(_mobIconV2Config.EnableBub?ir:rr);n=_mobIconV2Config.HasRewardsHeader?31:30;break;case 70:u=h(er);n=_mobIconV2Config.Type;break;case 50:u=h(or);n=_mobIconV2Config.Type;break;case 60:u=h(sr);n=_mobIconV2Config.Type}_mobIconV2Config.EnableBub&&!nt&&ii(ui("".concat(wt).concat(n)),vi)&&(d=n);v="header/mobupsellfly?customtype=".concat(n)}function h(n,i,r){var u,f;return i===void 0&&(i=!1),r===void 0&&(r=!1),t=n,u="".concat(r?ki:bi).concat(n),i&&(f=ct("q"),f&&(u+="&query=".concat(f))),u}function ui(n,t){var r,i;return(t===void 0&&(t=0),i=(r=_w.localStorage)===null||r===void 0?void 0:r.getItem(n),i&&i.length)?parseInt(i):t}function kr(){bt=!0;ti("initialize");n===null||n===void 0?void 0:n.setAttribute("href","#");n===null||n===void 0?void 0:n.removeAttribute("target");br();yr();dr()}function fi(){sj_be(_d,"click",o);sj_be(_w,"keydown",gt);w&&sj_be(w,"click",o);b&&sj_be(b,"click",o);k&&sj_be(k,"click",o)}function ei(){sj_ue(_d,"click",o);sj_ue(_d,"keydown",gt);w&&sj_ue(w,"click",o);b&&sj_ue(b,"click",o);k&&sj_ue(k,"click",o);i&&sj_ue(i,"click",si);i&&sj_ue(i,"keypress",oi);i&&sj_ue(i,"keydown",rt);f&&sj_ue(f,"keydown",rt)}function oi(){n&&n.focus();c("KeypressCloseBtn")}function si(n){n.stopPropagation();c("ClickCloseBtn")}function dr(){vt&&sj_be(vt,"click",cr);sj_be(n,"click",function(i){var u,f;Log.Log("Click","MobileIconV2","HeaderMobileIcon_Clicked");i===null||i===void 0?void 0:i.stopPropagation();s("ClickMobileIcon");p?c("ClickMobileIcon"):(Log.Log(r,t,ci),ht("ClickMobileIcon"),ot&&e&&(e.style.removeProperty("content"),e.style.removeProperty("height"),e.style.removeProperty("margin-left"),(u=n===null||n===void 0?void 0:n.style)===null||u===void 0?void 0:u.removeProperty("top"),(f=l===null||l===void 0?void 0:l.style)===null||f===void 0?void 0:f.removeProperty("bottom")),a&&Lib.CssClass.add(a,"b_hide"),ri(lt))})}function gr(){i=_ge("id_mobpopclose");f=_ge("id_mobpopcta");var n=_ge("id_mobpopcntr");i&&sj_be(i,"click",si);f&&sj_be(f,"click",function(n){return ni(n)});n&&sj_be(n,"click",function(n){return ni(n)});i&&sj_be(i,"keypress",oi);i&&sj_be(i,"keydown",rt);f&&sj_be(f,"keydown",rt)}function rt(n){if(n.key==="Tab"){var r=_qs(":focus"),t;r==i?t=f:r==f&&(t=i);t&&(n.preventDefault(),t.focus())}}typeof _mobIconV2Config=="undefined"&&(_mobIconV2Config={Type:0,HasRewardsHeader:!1,EnableBub:!1,IsHomepage:!1,EnableInstallChk:!1,AnimRes:null});var r="OpalUpsell",hi="Show",ci="Click",li=50,lt="MOBILE_ICON_CLICK_DT",ai="#id_h",at="mfo_c_bsic_id",vi=7,yi=7,n=_ge("id_mobile"),e=_ge("mob_img"),l=_qs("#id_mobile .mobicontxt"),a=null,w=_qs("#id_l"),b=_qs("#id_rh"),ut=_qs("#id_h"),ft=_qs("#sb_form"),et=_qs("#b_header"),k=_qs("#id_sc"),vt=_qs("#sb_sbi"),yt=_ge("b_sh_btn"),pt=0;yt&&(pt=yt.offsetWidth+16);var wt="SA_BUBBLE_DATETIME_",pi="SEARCH_BOX_CAMERA_CLICKED",wi="auth/getToken",bi="https://bingapp.microsoft.com/bing?at=",ki="https://bingapp.microsoft.com/bing-china?adjust=",di="1463xtye_14edso5c",gi="1f4mx3gt_1fbif41j",nr="14t7to0t_14ru3yvj",tr="1fp8xu3p_1foqsjuq",ir="145n7748_14cbvzz1",rr="1fdlr3u9_1flts8sx",ur="1dx1grbe_1dpg8ipe",fr="1dx1grbe_1dpg8ipe",er="1eichvfu_1e56jkx9",or="1e32iva6_1emkui5n",sr="1e4n8naa_1eo6jrog",t="",d=0,u="",v="",g="",y=null,bt=!1,nt=!1,p=!1,kt=!1,tt=!1,dt=!1,ot=!1,i,f;sj_evt.bind("bnp.embed.ready",function(n){var i=n[0],t=n[1];t.tar==ai&&(nt=!0,s("BnpConflictDetected"),c("BnpConflictDetected"))});sj_evt.bind("hideSydFSC",function(){if(st()){it("Overlap");s("Overlap");return}},!0);sj_be(_w,"resize",hr);st()&&(it("Overlap"),s("Overlap"));kr();_mobIconV2Config.EnableInstallChk&&ar(function(n){n&&n.length&&vr(n,function(n){n&&(it("Installed"),c("Installed"),s("Installed"))})})})(MobileIcon||(MobileIcon={}))